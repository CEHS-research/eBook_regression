<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression</title>
  <meta name="description" content="Correlation, Model Fit, Generalize, and Plot.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="EQM_v1_cover.png" />
  <meta property="og:description" content="Correlation, Model Fit, Generalize, and Plot." />
  <meta name="github-repo" content="cehs-research/eBook_wrangle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression" />
  
  <meta name="twitter:description" content="Correlation, Model Fit, Generalize, and Plot." />
  <meta name="twitter:image" content="EQM_v1_cover.png" />

<meta name="author" content="Sarah Schwartz &amp; Tyson Barrett">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="glm-logistic-example-bpd.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="heading.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vol. 4: Multiple Linear Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#blocked-notes"><i class="fa fa-check"></i>Blocked Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-and-output"><i class="fa fa-check"></i>Code and Output</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The Authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-choose-r"><i class="fa fa-check"></i>Why choose R ?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#fyi"><i class="fa fa-check"></i>FYI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html"><i class="fa fa-check"></i><b>1</b> Example: Ventricular Shortening Velocity (simple linear regression)</a><ul>
<li class="chapter" data-level="1.1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a><ul>
<li class="chapter" data-level="1.1.1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#research-question"><i class="fa fa-check"></i><b>1.1.1</b> Research Question</a></li>
<li class="chapter" data-level="1.1.2" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#data-description"><i class="fa fa-check"></i><b>1.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#univariate-statistics"><i class="fa fa-check"></i><b>1.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="1.2.2" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#univariate-visualizations"><i class="fa fa-check"></i><b>1.2.2</b> Univariate Visualizations</a></li>
<li class="chapter" data-level="1.2.3" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#bivariate-statistics-unadjusted-pearsons-correlation"><i class="fa fa-check"></i><b>1.2.3</b> Bivariate Statistics (Unadjusted Pearson’s correlation)</a></li>
<li class="chapter" data-level="1.2.4" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#bivariate-visualization"><i class="fa fa-check"></i><b>1.2.4</b> Bivariate Visualization</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#regression-analysis"><i class="fa fa-check"></i><b>1.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="1.3.1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#fit-a-simple-linear-model"><i class="fa fa-check"></i><b>1.3.1</b> Fit A Simple Linear Model</a></li>
<li class="chapter" data-level="1.3.2" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#checking-assumptions-via-residual-diagnostics"><i class="fa fa-check"></i><b>1.3.2</b> Checking Assumptions via Residual Diagnostics</a></li>
<li class="chapter" data-level="1.3.3" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#manually-checking-residual-diagnostics"><i class="fa fa-check"></i><b>1.3.3</b> Manually checking residual diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>1.4</b> Conclusion</a><ul>
<li class="chapter" data-level="1.4.1" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#tabulate-the-final-model-summary"><i class="fa fa-check"></i><b>1.4.1</b> Tabulate the Final Model Summary</a></li>
<li class="chapter" data-level="1.4.2" data-path="example-ventricular-shortening-velocity-simple-linear-regression.html"><a href="example-ventricular-shortening-velocity-simple-linear-regression.html#plot-the-model"><i class="fa fa-check"></i><b>1.4.2</b> Plot the Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><i class="fa fa-check"></i><b>2</b> Example: Obesity and Blood Pressure (interaction between a continuous and categorical IVs)</a><ul>
<li class="chapter" data-level="2.1" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#purpose-1"><i class="fa fa-check"></i><b>2.1</b> Purpose</a><ul>
<li class="chapter" data-level="2.1.1" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#research-question-1"><i class="fa fa-check"></i><b>2.1.1</b> Research Question</a></li>
<li class="chapter" data-level="2.1.2" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#data-description-1"><i class="fa fa-check"></i><b>2.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>2.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#univariate-statistics-1"><i class="fa fa-check"></i><b>2.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="2.2.2" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#bivariate-relationships"><i class="fa fa-check"></i><b>2.2.2</b> Bivariate Relationships</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#regression-analysis-1"><i class="fa fa-check"></i><b>2.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#fit-nested-models"><i class="fa fa-check"></i><b>2.3.1</b> Fit Nested Models</a></li>
<li class="chapter" data-level="2.3.2" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#comparing-nested-models"><i class="fa fa-check"></i><b>2.3.2</b> Comparing Nested Models</a></li>
<li class="chapter" data-level="2.3.3" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#checking-assumptions-via-residual-diagnostics-1"><i class="fa fa-check"></i><b>2.3.3</b> Checking Assumptions via Residual Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="example-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#conclusion-1"><i class="fa fa-check"></i><b>2.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><i class="fa fa-check"></i><b>3</b> Example: Ihno’s Experiment (interaction between two continuous IVs)</a><ul>
<li class="chapter" data-level="3.1" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#purpose-2"><i class="fa fa-check"></i><b>3.1</b> Purpose</a><ul>
<li class="chapter" data-level="3.1.1" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#research-question-2"><i class="fa fa-check"></i><b>3.1.1</b> Research Question</a></li>
<li class="chapter" data-level="3.1.2" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#data-description-2"><i class="fa fa-check"></i><b>3.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#exploratory-data-analysis-2"><i class="fa fa-check"></i><b>3.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="3.2.1" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#univariate-statistics-2"><i class="fa fa-check"></i><b>3.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="3.2.2" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#bivariate-relationships-1"><i class="fa fa-check"></i><b>3.2.2</b> Bivariate Relationships</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#regression-analysis-2"><i class="fa fa-check"></i><b>3.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#subset-the-sample"><i class="fa fa-check"></i><b>3.3.1</b> Subset the Sample</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#fit-nested-models-1"><i class="fa fa-check"></i><b>3.3.2</b> Fit Nested Models</a></li>
<li class="chapter" data-level="3.3.3" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#comparing-nested-models-1"><i class="fa fa-check"></i><b>3.3.3</b> Comparing Nested Models</a></li>
<li class="chapter" data-level="3.3.4" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#checking-assumptions-via-residual-diagnostics-2"><i class="fa fa-check"></i><b>3.3.4</b> Checking Assumptions via Residual Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#conclusion-2"><i class="fa fa-check"></i><b>3.4</b> Conclusion</a><ul>
<li class="chapter" data-level="3.4.1" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#tabulate-the-final-model-summary-1"><i class="fa fa-check"></i><b>3.4.1</b> Tabulate the Final Model Summary</a></li>
<li class="chapter" data-level="3.4.2" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#plot-the-model-1"><i class="fa fa-check"></i><b>3.4.2</b> Plot the Model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="example-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="example-ihnos-experiment-interaction-between-two-continuous-ivs.html#write-up"><i class="fa fa-check"></i><b>3.5</b> Write-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html"><i class="fa fa-check"></i><b>4</b> GLM - Logistic: Example, BPD</a><ul>
<li class="chapter" data-level="4.1" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#background"><i class="fa fa-check"></i><b>4.1</b> Background</a><ul>
<li class="chapter" data-level="4.1.1" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#source"><i class="fa fa-check"></i><b>4.1.1</b> Source</a></li>
<li class="chapter" data-level="4.1.2" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#reference"><i class="fa fa-check"></i><b>4.1.2</b> Reference</a></li>
<li class="chapter" data-level="4.1.3" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#variables"><i class="fa fa-check"></i><b>4.1.3</b> Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#logistic-regresion"><i class="fa fa-check"></i><b>4.2</b> Logistic Regresion</a><ul>
<li class="chapter" data-level="4.2.1" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#fit-the-models"><i class="fa fa-check"></i><b>4.2.1</b> Fit the Models</a></li>
<li class="chapter" data-level="4.2.2" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#gof-measures"><i class="fa fa-check"></i><b>4.2.2</b> GoF Measures</a></li>
<li class="chapter" data-level="4.2.3" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#parameter-estimates"><i class="fa fa-check"></i><b>4.2.3</b> Parameter Estimates</a></li>
<li class="chapter" data-level="4.2.4" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#significance-of-terms"><i class="fa fa-check"></i><b>4.2.4</b> Significance of Terms</a></li>
<li class="chapter" data-level="4.2.5" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#parameter-estimates-1"><i class="fa fa-check"></i><b>4.2.5</b> Parameter Estimates</a></li>
<li class="chapter" data-level="4.2.6" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#marginal-model-plot"><i class="fa fa-check"></i><b>4.2.6</b> Marginal Model Plot</a></li>
<li class="chapter" data-level="4.2.7" data-path="glm-logistic-example-bpd.html"><a href="glm-logistic-example-bpd.html#residual-diagnostics"><i class="fa fa-check"></i><b>4.2.7</b> Residual Diagnostics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="glm-logistic.html"><a href="glm-logistic.html"><i class="fa fa-check"></i><b>5</b> GLM - Logistic:</a><ul>
<li class="chapter" data-level="5.1" data-path="glm-logistic.html"><a href="glm-logistic.html#background-1"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="glm-logistic.html"><a href="glm-logistic.html#logistic-regression---simple-un-adjusted"><i class="fa fa-check"></i><b>5.2</b> Logistic Regression - Simple, un-adjusted</a></li>
<li class="chapter" data-level="5.3" data-path="glm-logistic.html"><a href="glm-logistic.html#logistic-regression---multivariate-with-main-effects-only"><i class="fa fa-check"></i><b>5.3</b> Logistic Regression - Multivariate with Main Effects Only</a></li>
<li class="chapter" data-level="5.4" data-path="glm-logistic.html"><a href="glm-logistic.html#logistic-regression---multivariate-with-interactions"><i class="fa fa-check"></i><b>5.4</b> Logistic Regression - Multivariate with Interactions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="glm-logistic.html"><a href="glm-logistic.html#age-and-weight"><i class="fa fa-check"></i><b>5.4.1</b> Age and Weight</a></li>
<li class="chapter" data-level="5.4.2" data-path="glm-logistic.html"><a href="glm-logistic.html#age-and-smoking"><i class="fa fa-check"></i><b>5.4.2</b> Age and Smoking</a></li>
<li class="chapter" data-level="5.4.3" data-path="glm-logistic.html"><a href="glm-logistic.html#weight-and-smoking"><i class="fa fa-check"></i><b>5.4.3</b> Weight and Smoking</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="glm-logistic.html"><a href="glm-logistic.html#logistic-regression---multivariate-simplify"><i class="fa fa-check"></i><b>5.5</b> Logistic Regression - Multivariate, Simplify</a><ul>
<li class="chapter" data-level="5.5.1" data-path="glm-logistic.html"><a href="glm-logistic.html#removing-ui"><i class="fa fa-check"></i><b>5.5.1</b> Removing <code>ui</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="glm-logistic.html"><a href="glm-logistic.html#several-r2-measures-with-the-psclpr2-function"><i class="fa fa-check"></i><b>5.5.2</b> Several <span class="math inline">\(R^2\)</span> measures with the <code>pscl::pR2()</code> function</a></li>
<li class="chapter" data-level="5.5.3" data-path="glm-logistic.html"><a href="glm-logistic.html#parameter-estiamtes"><i class="fa fa-check"></i><b>5.5.3</b> Parameter Estiamtes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm---logistic" class="section level1">
<h1><span class="header-section-number">5</span> GLM - Logistic:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span>
<span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span>
<span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span>
<span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span>
<span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span>
<span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression</span>
<span class="kw">library</span>(pscl)         <span class="co"># psudo R-squared function</span></code></pre></div>
<div id="background-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Background</h2>
<p>More complex example demonstrating modeling decisions</p>
<p>Another set of data from a study investigating predictors of low birth weight</p>
<ul>
<li><code>id</code> infant id</li>
<li><code>low</code> Low birth weight (outcome) (0 = birth weight &gt;2500 g (normal), 1 = birth weight &lt; 2500 g (low))</li>
<li><code>age</code> Age of mother (yrs)</li>
<li><code>lwt</code> Mother’s weight at last menstrual period (pounds)</li>
<li><code>race</code> Race (1 = White, 2 = Black, 3 = Other)</li>
<li><code>smoke</code> Smoking status during pregnancy (1 = Yes, 0 = No)</li>
<li><code>ptl</code> History of premature labor (0 = None, 1 = One, etc)</li>
<li><code>ht</code> History of hypertension (1 = Yes, 0 = No)</li>
<li><code>ui</code> Uterine irritability (1 = Yes, 0 = No)</li>
<li><code>ftv</code> Number of physician visits in 1st trimester (0=None, 1=One, etc)</li>
<li><code>bwt</code> actual infant birth weight in g</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lowbwt_raw &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/lowbwt.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>, <span class="dt">na.strings=</span><span class="st">&quot;NA&quot;</span>, <span class="dt">dec=</span><span class="st">&quot;.&quot;</span>, <span class="dt">strip.white=</span><span class="ot">TRUE</span>)

tibble<span class="op">::</span><span class="kw">glimpse</span>(lowbwt_raw)</code></pre></div>
<pre><code>Observations: 189
Variables: 11
$ id    &lt;int&gt; 85, 86, 87, 88, 89, 91, 92, 93, 94, 95, 96, 97, 98, 99, ...
$ low   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ age   &lt;int&gt; 19, 33, 20, 21, 18, 21, 22, 17, 29, 26, 19, 19, 22, 30, ...
$ lwt   &lt;int&gt; 182, 155, 105, 108, 107, 124, 118, 103, 123, 113, 95, 15...
$ race  &lt;int&gt; 2, 3, 1, 1, 1, 3, 1, 3, 1, 1, 3, 3, 3, 3, 1, 1, 2, 1, 3,...
$ smoke &lt;int&gt; 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0,...
$ ptl   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,...
$ ht    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,...
$ ui    &lt;int&gt; 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1,...
$ ftv   &lt;int&gt; 0, 3, 1, 2, 0, 0, 1, 1, 1, 0, 0, 1, 0, 2, 0, 0, 0, 3, 0,...
$ bwt   &lt;int&gt; 2523, 2551, 2557, 2594, 2600, 2622, 2637, 2637, 2663, 26...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lowbwt_clean &lt;-<span class="st"> </span>lowbwt_raw <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">low =</span> <span class="kw">factor</span>(low,
                             <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),
                             <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;birth weight &gt;2500 g (normal)&quot;</span>,
                                        <span class="st">&quot;birth weight &lt; 2500 g (low)&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">race =</span> <span class="kw">factor</span>(race,
                              <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
                              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>, <span class="st">&quot;Other&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(smoke, ht, ui),
                   factor,
                   <span class="dt">levels =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(lowbwt_clean)</code></pre></div>
<pre><code>&#39;data.frame&#39;:   189 obs. of  11 variables:
 $ id   : Factor w/ 189 levels &quot;4&quot;,&quot;10&quot;,&quot;11&quot;,..: 60 61 62 63 64 65 66 67 68 69 ...
 $ low  : Factor w/ 2 levels &quot;birth weight &gt;2500 g (normal)&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ age  : int  19 33 20 21 18 21 22 17 29 26 ...
 $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...
 $ race : Factor w/ 3 levels &quot;White&quot;,&quot;Black&quot;,..: 2 3 1 1 1 3 1 3 1 1 ...
 $ smoke: Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 2 2 2 1 1 1 2 2 ...
 $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ht   : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ ui   : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 1 1 2 2 1 1 1 1 1 ...
 $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...
 $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lowbwt_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(age, lwt, race, smoke, ptl, ht, ui, ftv, bwt,
                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>low,
                    <span class="dt">test =</span> <span class="ot">TRUE</span>,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
birth weight &gt;2500 g (normal)
</th>
<th>
birth weight &lt; 2500 g (low)
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 130
</td>
<td>
n = 59
</td>
<td>
</td>
</tr>
<tr>
<td>
age
</td>
<td>
</td>
<td>
</td>
<td>
0.078
</td>
</tr>
<tr>
<td>
</td>
<td>
23.7 (5.6)
</td>
<td>
22.3 (4.5)
</td>
<td>
</td>
</tr>
<tr>
<td>
lwt
</td>
<td>
</td>
<td>
</td>
<td>
0.013
</td>
</tr>
<tr>
<td>
</td>
<td>
133.3 (31.7)
</td>
<td>
122.1 (26.6)
</td>
<td>
</td>
</tr>
<tr>
<td>
race
</td>
<td>
</td>
<td>
</td>
<td>
0.082
</td>
</tr>
<tr>
<td>
White
</td>
<td>
73 (56.2%)
</td>
<td>
23 (39%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Black
</td>
<td>
15 (11.5%)
</td>
<td>
11 (18.6%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Other
</td>
<td>
42 (32.3%)
</td>
<td>
25 (42.4%)
</td>
<td>
</td>
</tr>
<tr>
<td>
smoke
</td>
<td>
</td>
<td>
</td>
<td>
0.04
</td>
</tr>
<tr>
<td>
No
</td>
<td>
86 (66.2%)
</td>
<td>
29 (49.2%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Yes
</td>
<td>
44 (33.8%)
</td>
<td>
30 (50.8%)
</td>
<td>
</td>
</tr>
<tr>
<td>
ptl
</td>
<td>
</td>
<td>
</td>
<td>
0.012
</td>
</tr>
<tr>
<td>
</td>
<td>
0.1 (0.5)
</td>
<td>
0.3 (0.5)
</td>
<td>
</td>
</tr>
<tr>
<td>
ht
</td>
<td>
</td>
<td>
</td>
<td>
0.076
</td>
</tr>
<tr>
<td>
No
</td>
<td>
125 (96.2%)
</td>
<td>
52 (88.1%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Yes
</td>
<td>
5 (3.8%)
</td>
<td>
7 (11.9%)
</td>
<td>
</td>
</tr>
<tr>
<td>
ui
</td>
<td>
</td>
<td>
</td>
<td>
0.035
</td>
</tr>
<tr>
<td>
No
</td>
<td>
116 (89.2%)
</td>
<td>
45 (76.3%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Yes
</td>
<td>
14 (10.8%)
</td>
<td>
14 (23.7%)
</td>
<td>
</td>
</tr>
<tr>
<td>
ftv
</td>
<td>
</td>
<td>
</td>
<td>
0.385
</td>
</tr>
<tr>
<td>
</td>
<td>
0.8 (1.1)
</td>
<td>
0.7 (1.0)
</td>
<td>
</td>
</tr>
<tr>
<td>
bwt
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
3330.9 (476.2)
</td>
<td>
2097.1 (390.9)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div id="logistic-regression---simple-un-adjusted" class="section level2">
<h2><span class="header-section-number">5.2</span> Logistic Regression - Simple, un-adjusted</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1.age   &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age,   <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.lwt   &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>lwt,   <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.race  &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>race,  <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.smoke &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>smoke, <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.ptl   &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>ptl,   <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.ht    &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>ht,    <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.ui    &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>ui,    <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)
low1.ftv   &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>ftv,   <span class="dt">family=</span><span class="kw">binomial</span>(logit), <span class="dt">data=</span>lowbwt_clean)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(low1.age, low1.lwt, low1.race, low1.smoke),
                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Weight&quot;</span>, <span class="st">&quot;Race&quot;</span>, <span class="st">&quot;Smoker&quot;</span>),
                  <span class="dt">caption =</span> <span class="st">&quot;Mother Factors&quot;</span>)</code></pre></div>
<pre><code>
=============================================================
                Age       Weight     Race         Smoker     
-------------------------------------------------------------
(Intercept)        0.38      1.00      -1.15 ***    -1.09 ***
                  (0.73)    (0.79)     (0.24)       (0.21)   
age               -0.05                                      
                  (0.03)                                     
lwt                         -0.01 *                          
                            (0.01)                           
raceBlack                               0.84                 
                                       (0.46)                
raceOther                               0.64                 
                                       (0.35)                
smokeYes                                             0.70 *  
                                                    (0.32)   
-------------------------------------------------------------
AIC              235.91    232.69     235.66       233.80    
BIC              242.40    239.17     245.39       240.29    
Log Likelihood  -115.96   -114.35    -114.83      -114.90    
Deviance         231.91    228.69     229.66       229.80    
Num. obs.        189       189        189          189       
=============================================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(low1.ptl, low1.ht, low1.ui, low1.ftv),
                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Pre-Labor&quot;</span>, <span class="st">&quot;Hypertension&quot;</span>, <span class="st">&quot;Uterine&quot;</span>, <span class="st">&quot;Visits&quot;</span>))</code></pre></div>
<pre><code>
===================================================================
                Pre-Labor    Hypertension  Uterine      Visits     
-------------------------------------------------------------------
(Intercept)       -0.96 ***    -0.88 ***     -0.95 ***    -0.69 ***
                  (0.17)       (0.17)        (0.18)       (0.19)   
ptl                0.80 *                                          
                  (0.32)                                           
htYes                           1.21 *                             
                               (0.61)                              
uiYes                                         0.95 *               
                                             (0.42)                
ftv                                                       -0.14    
                                                          (0.16)   
-------------------------------------------------------------------
AIC              231.89       234.65        233.60       237.90    
BIC              238.38       241.13        240.08       244.38    
Log Likelihood  -113.95      -115.32       -114.80      -116.95    
Deviance         227.89       230.65        229.60       233.90    
Num. obs.        189          189           189          189       
===================================================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
</div>
<div id="logistic-regression---multivariate-with-main-effects-only" class="section level2">
<h2><span class="header-section-number">5.3</span> Logistic Regression - Multivariate with Main Effects Only</h2>
<p>Main-effects multiple logistic regression model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht <span class="op">+</span><span class="st"> </span>ui,
              <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
              <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">1</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ age + lwt + race + smoke + ptl + ht + ui, 
    family = binomial(logit), data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9120  -0.8174  -0.5224   0.9714   2.1807  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  0.464403   1.204687   0.385  0.69987   
age         -0.027070   0.036452  -0.743  0.45772   
lwt         -0.015183   0.006928  -2.192  0.02841 * 
raceBlack    1.263219   0.526463   2.399  0.01642 * 
raceOther    0.861635   0.439191   1.962  0.04978 * 
smokeYes     0.923349   0.400853   2.303  0.02125 * 
ptl          0.541755   0.346264   1.565  0.11768   
htYes        1.833696   0.691765   2.651  0.00803 **
uiYes        0.758597   0.459389   1.651  0.09867 . 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 201.43  on 180  degrees of freedom
AIC: 219.43

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="logistic-regression---multivariate-with-interactions" class="section level2">
<h2><span class="header-section-number">5.4</span> Logistic Regression - Multivariate with Interactions</h2>
<p>Before removing non-significant main effects, test plausible interactions</p>
<p>Try interactions between age and lwt, age and smoke, lwt and smoke, 1 at a time</p>
<div id="age-and-weight" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Age and Weight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht <span class="op">+</span><span class="st"> </span>ui <span class="op">+</span><span class="st"> </span>age<span class="op">:</span>lwt,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
                 <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">2</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ age + lwt + race + smoke + ptl + ht + ui + 
    age:lwt, family = binomial(logit), data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9117  -0.8177  -0.5226   0.9719   2.1803  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  6.375e-01  3.998e+00   0.159  0.87330   
age         -3.461e-02  1.699e-01  -0.204  0.83860   
lwt         -1.654e-02  3.074e-02  -0.538  0.59048   
raceBlack    1.261e+00  5.280e-01   2.389  0.01689 * 
raceOther    8.592e-01  4.421e-01   1.943  0.05197 . 
smokeYes     9.222e-01  4.015e-01   2.297  0.02163 * 
ptl          5.427e-01  3.470e-01   1.564  0.11779   
htYes        1.834e+00  6.919e-01   2.651  0.00803 **
uiYes        7.598e-01  4.603e-01   1.651  0.09882 . 
age:lwt      5.935e-05  1.306e-03   0.045  0.96375   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 201.42  on 179  degrees of freedom
AIC: 221.42

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(low1_<span class="dv">1</span>, low1_<span class="dv">2</span>, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</code></pre></div>
<pre><code># A tibble: 2 x 5
  `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
*       &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1         180         201.    NA NA           NA    
2         179         201.     1  0.00206      0.964</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(low1_<span class="dv">2</span>, <span class="dt">test =</span> <span class="st">&#39;LR&#39;</span>) <span class="co">#Type II Analysis of Deviance table</span></code></pre></div>
<pre><code># A tibble: 8 x 3
  `LR Chisq`    Df `Pr(&gt;Chisq)`
*      &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
1    0.559       1      0.455  
2    5.38        1      0.0204 
3    7.23        2      0.0270 
4    5.46        1      0.0194 
5    2.52        1      0.112  
6    7.39        1      0.00658
7    2.68        1      0.102  
8    0.00206     1      0.964  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(low1_<span class="dv">2</span>, <span class="dt">test =</span> <span class="st">&#39;LR&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;III&#39;</span>) <span class="co">#Type III Analysis of Deviance table</span></code></pre></div>
<pre><code># A tibble: 8 x 3
  `LR Chisq`    Df `Pr(&gt;Chisq)`
*      &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
1    0.0413      1      0.839  
2    0.290       1      0.590  
3    7.23        2      0.0270 
4    5.46        1      0.0194 
5    2.52        1      0.112  
6    7.39        1      0.00658
7    2.68        1      0.102  
8    0.00206     1      0.964  </code></pre>
</div>
<div id="age-and-smoking" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Age and Smoking</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht <span class="op">+</span><span class="st"> </span>ui <span class="op">+</span><span class="st"> </span>age<span class="op">:</span>smoke,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
                 <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">3</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ age + lwt + race + smoke + ptl + ht + ui + 
    age:smoke, family = binomial(logit), data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9578  -0.8387  -0.5121   0.9862   2.1932  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   1.162890   1.455841   0.799  0.42442   
age          -0.058516   0.052407  -1.117  0.26418   
lwt          -0.014992   0.006878  -2.180  0.02929 * 
raceBlack     1.174317   0.537051   2.187  0.02877 * 
raceOther     0.825523   0.442058   1.867  0.06184 . 
smokeYes     -0.562054   1.742706  -0.323  0.74706   
ptl           0.525377   0.346143   1.518  0.12906   
htYes         1.862868   0.695622   2.678  0.00741 **
uiYes         0.834722   0.468785   1.781  0.07498 . 
age:smokeYes  0.065307   0.074818   0.873  0.38272   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 200.66  on 179  degrees of freedom
AIC: 220.66

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(low1_<span class="dv">1</span>, low1_<span class="dv">3</span>, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</code></pre></div>
<pre><code># A tibble: 2 x 5
  `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
*       &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1         180         201.    NA   NA         NA    
2         179         201.     1    0.770      0.380</code></pre>
</div>
<div id="weight-and-smoking" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Weight and Smoking</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht <span class="op">+</span><span class="st"> </span>ui <span class="op">+</span><span class="st"> </span>lwt<span class="op">:</span>smoke,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
                 <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">4</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ age + lwt + race + smoke + ptl + ht + ui + 
    lwt:smoke, family = binomial(logit), data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8924  -0.8089  -0.5399   0.9928   2.2129  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)   1.45738    1.55248   0.939   0.3479  
age          -0.02676    0.03670  -0.729   0.4659  
lwt          -0.02299    0.01051  -2.187   0.0287 *
raceBlack     1.28222    0.52798   2.429   0.0152 *
raceOther     0.78463    0.44213   1.775   0.0760 .
smokeYes     -0.85555    1.71464  -0.499   0.6178  
ptl           0.56700    0.34704   1.634   0.1023  
htYes         1.75771    0.69767   2.519   0.0118 *
uiYes         0.83264    0.46555   1.789   0.0737 .
lwt:smokeYes  0.01396    0.01313   1.063   0.2878  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 200.26  on 179  degrees of freedom
AIC: 220.26

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(low1_<span class="dv">1</span>, low1_<span class="dv">4</span>, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</code></pre></div>
<pre><code># A tibble: 2 x 5
  `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
*       &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1         180         201.    NA    NA        NA    
2         179         200.     1     1.17      0.280</code></pre>
</div>
</div>
<div id="logistic-regression---multivariate-simplify" class="section level2">
<h2><span class="header-section-number">5.5</span> Logistic Regression - Multivariate, Simplify</h2>
<p>No interactions are significant Remove non-significant main effects</p>
<div id="removing-ui" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Removing <code>ui</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
                 <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">5</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ age + lwt + race + smoke + ptl + ht, family = binomial(logit), 
    data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7699  -0.8502  -0.5482   0.9691   2.1526  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)  0.74110    1.17816   0.629   0.5293  
age         -0.03194    0.03620  -0.882   0.3777  
lwt         -0.01560    0.00694  -2.248   0.0246 *
raceBlack    1.21986    0.52575   2.320   0.0203 *
raceOther    0.87396    0.43368   2.015   0.0439 *
smokeYes     0.93253    0.39737   2.347   0.0189 *
ptl          0.64623    0.33954   1.903   0.0570 .
htYes        1.72251    0.69012   2.496   0.0126 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 204.11  on 181  degrees of freedom
AIC: 220.11

Number of Fisher Scoring iterations: 4</code></pre>
<p>age and ptl are theoretically meaningful variables, should probably retain them</p>
<p>Revise so that age is interpreted in 5-year and lwt in 20 lb increments</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">low1_<span class="dv">6</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(low <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(lwt<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ptl <span class="op">+</span><span class="st"> </span>ht,
              <span class="dt">family =</span> <span class="kw">binomial</span>(logit), 
              <span class="dt">data =</span> lowbwt_clean)

<span class="kw">summary</span>(low1_<span class="dv">6</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = low ~ I(age * (1/5)) + I(lwt * (1/20)) + race + 
    smoke + ptl + ht, family = binomial(logit), data = lowbwt_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7699  -0.8502  -0.5482   0.9691   2.1526  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)       0.7411     1.1782   0.629   0.5293  
I(age * (1/5))   -0.1597     0.1810  -0.882   0.3777  
I(lwt * (1/20))  -0.3120     0.1388  -2.248   0.0246 *
raceBlack         1.2199     0.5258   2.320   0.0203 *
raceOther         0.8740     0.4337   2.015   0.0439 *
smokeYes          0.9325     0.3974   2.347   0.0189 *
ptl               0.6462     0.3395   1.903   0.0570 .
htYes             1.7225     0.6901   2.496   0.0126 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 204.11  on 181  degrees of freedom
AIC: 220.11

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="several-r2-measures-with-the-psclpr2-function" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Several <span class="math inline">\(R^2\)</span> measures with the <code>pscl::pR2()</code> function</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pscl<span class="op">::</span><span class="kw">pR2</span>(low1_<span class="dv">6</span>)</code></pre></div>
<pre><code>         llh      llhNull           G2     McFadden         r2ML 
-102.0532300 -117.3359981   30.5655362    0.1302479    0.1493227 
        r2CU 
   0.2099904 </code></pre>
</div>
<div id="parameter-estiamtes" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Parameter Estiamtes</h3>
<p>Parameters Exponentiated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjPlot<span class="op">::</span><span class="kw">tab_model</span>(low1_<span class="dv">6</span>,
                  <span class="dt">emph.p =</span> <span class="ot">TRUE</span>,
                  <span class="dt">pred.labels =</span> <span class="kw">c</span>(<span class="st">&quot;(Intercept)&quot;</span>,
                                  <span class="st">&quot;Age: 5 years&quot;</span>,
                                  <span class="st">&quot;Weight: 20 lbs&quot;</span>,
                                  <span class="st">&quot;Race: Black vs. White&quot;</span>,
                                  <span class="st">&quot;Race: Other vs. White&quot;</span>,
                                  <span class="st">&quot;Smoker During pregnancy&quot;</span>,
                                  <span class="st">&quot;History of Premature Labor&quot;</span>,
                                  <span class="st">&quot;History of Hypertension&quot;</span>)) </code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
low
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22 – 22.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.529
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age: 5 years
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.59 – 1.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.378
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Weight: 20 lbs
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.55 – 0.95
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.025</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Race: Black vs. White
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.21 – 9.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.020</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Race: Other vs. White
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.04 – 5.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.044</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Smoker During pregnancy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.54
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.18 – 5.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.019</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
History of Premature Labor
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.99 – 3.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.057
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
History of Hypertension
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
5.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.50 – 23.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.013</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
189
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Cox &amp; Snell’s R<sup>2</sup> / Nagelkerke’s R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.149 / 0.210
</td>
</tr>
<table style="border-collapse:collapse; border:none;">

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm-logistic-example-bpd.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"toc_depth": 3
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
