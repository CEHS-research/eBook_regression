[
["index.html", "Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression Welcome Blocked Notes Code and Output Why choose R ? The Authors FYI", " Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression Sarah Schwartz &amp; Tyson Barrett Last updated: 2018-09-06 Welcome Backgroup and links to other volumes of this encyclopedia may be found at the Encyclopedia’s Home Website. Blocked Notes Thoughout all the eBooks in this encyclopedia, several small secitons will be blocked out in the following ways: These blocks denote an area UNDER CONSTRUCTION, so check back often. This massive undertaking started during the summer of 2018 and is far from complete. The outline of seven volumes is given above despite any one being complete. Feedback is welcome via either author’s email. These blocks denote something EXTREMELY IMPORTANT. Do NOT skip these notes as they will be used very sparingly. These blocks denote something to DOWNLOAD. This may include software installations, example datasets, or notebook code files. These blocks denote something INTERESTING. These point out information we found of interest or added value. These blocks denote LINKS to other websites. This may include instructional video clips, articles, or blog posts. We are all about NOT re-creating the wheel. If somebody else has described or illustrated a topic well, we celebrate it! Code and Output This is how \\(R\\) code is shown: 1 + 1 THis is what the output of the \\(R\\) code above will look: ## [1] 2 Why choose R ? Check it out: an article from Fall 2016… No more excuses: R is better than SPSS for psychology undergrads, and students agree The Authors Dr. Sarah Schwartz Dr. Tyson Barrett www.SarahSchwartzStats.com www.TysonBarrett.com Sarah.Schwartz@usu.edu Tyson.Barrett@usu.edu Statistical Consulting Studio Data Science and Discover Unit FYI This entire encyclopedia is written in \\(R Markdown\\), using \\(R Studio\\) as the text editor and the bookdown package to turn a collection of markdown documents into a coherent whole. The book’s source code is hosted on GitHub. If you notice typos or other issues, feel free to email either of the authors. This work is licensed under the Attribution-NonCommercial-NoDerivatives 4.0 International License. "],
["example-ihnos-experiment.html", "1 Example: Ihno’s Experiment 1.1 Packages 1.2 The Data 1.3 Regression", " 1 Example: Ihno’s Experiment 1.1 Packages library(tidyverse) library(haven) library(furniture) library(texreg) library(stargazer) 1.2 The Data Author’s website for the textbook: http://www.psych.nyu.edu/cohen/EPS4e.html data_ihno &lt;- read_spss(&quot;http://www.psych.nyu.edu/cohen/Ihno_dataset.sav&quot;) %&gt;% dplyr::rename_all(tolower) %&gt;% dplyr::mutate(gender = factor(gender, levels = c(1, 2), labels = c(&quot;Female&quot;, &quot;Male&quot;))) %&gt;% dplyr::mutate(major = factor(major, levels = c(1, 2, 3, 4,5), labels = c(&quot;Psychology&quot;, &quot;Premed&quot;, &quot;Biology&quot;, &quot;Sociology&quot;, &quot;Economics&quot;))) %&gt;% dplyr::mutate(reason = factor(reason, levels = c(1, 2, 3), labels = c(&quot;Program requirement&quot;, &quot;Personal interest&quot;, &quot;Advisor recommendation&quot;))) %&gt;% dplyr::mutate(exp_cond = factor(exp_cond, levels = c(1, 2, 3, 4), labels = c(&quot;Easy&quot;, &quot;Moderate&quot;, &quot;Difficult&quot;, &quot;Impossible&quot;))) %&gt;% dplyr::mutate(coffee = factor(coffee, levels = c(0, 1), labels = c(&quot;Not a regular coffee drinker&quot;, &quot;Regularly drinks coffee&quot;))) data_ihno ## # A tibble: 100 x 18 ## sub_num gender major reason exp_cond coffee num_cups phobia prevmath ## &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 Female Psyc~ Advis~ Easy Regul~ 0 1 3 ## 2 2 Female Psyc~ Perso~ Easy Not a~ 0 1 4 ## 3 3 Female Psyc~ Progr~ Easy Not a~ 0 4 1 ## 4 4 Female Psyc~ Progr~ Easy Not a~ 0 4 0 ## 5 5 Female Psyc~ Progr~ Easy Not a~ 1 10 1 ## 6 6 Female Psyc~ Progr~ Moderate Regul~ 1 4 1 ## 7 7 Female Psyc~ Progr~ Moderate Not a~ 0 4 2 ## 8 8 Female Psyc~ Advis~ Moderate Regul~ 2 4 1 ## 9 9 Female Psyc~ Progr~ Moderate Not a~ 0 4 1 ## 10 10 Female Psyc~ Progr~ Moderate Regul~ 2 5 0 ## # ... with 90 more rows, and 9 more variables: mathquiz &lt;dbl&gt;, ## # statquiz &lt;dbl&gt;, exp_sqz &lt;dbl&gt;, hr_base &lt;dbl&gt;, hr_pre &lt;dbl&gt;, ## # hr_post &lt;dbl&gt;, anx_base &lt;dbl&gt;, anx_pre &lt;dbl&gt;, anx_post &lt;dbl&gt; 1.2.1 Describe the Raw Data 1.2.1.1 Table of Summary Statistics data_ihno %&gt;% furniture::table1(phobia, statquiz, mathquiz, test = TRUE, output = &quot;markdown&quot;) Mean/Count (SD/%) n = 100 phobia 3.3 (2.4) statquiz 6.9 (1.7) mathquiz 29.1 (9.5) data_ihno %&gt;% dplyr::mutate(phobia_cut3 = cut(phobia, breaks = c(0, 2, 4, 10), include.lowest = TRUE)) %&gt;% furniture::table1(phobia, statquiz, mathquiz, splitby = ~ phobia_cut3, test = TRUE, output = &quot;markdown&quot;) [0,2] (2,4] (4,10] P-Value n = 39 n = 37 n = 24 phobia &lt;.001 1.0 (0.8) 3.6 (0.5) 6.7 (1.8) statquiz 0.001 7.6 (1.3) 6.6 (1.6) 6.1 (2.0) mathquiz 0.014 32.6 (8.5) 26.5 (9.8) 26.8 (8.9) 1.2.1.2 Plot of Raw Data data_ihno %&gt;% ggplot() + aes(phobia) + geom_histogram(binwidth = 1) data_ihno %&gt;% dplyr::mutate(phobia_cut3 = cut(phobia, breaks = c(0, 2, 4, 10), include.lowest = TRUE)) %&gt;% ggplot() + aes(phobia, fill = phobia_cut3) + geom_histogram(binwidth = 1) data_ihno %&gt;% ggplot() + aes(x = mathquiz, y = statquiz) + geom_point() ## Warning: Removed 15 rows containing missing values (geom_point). data_ihno %&gt;% dplyr::mutate(phobia_cut3 = cut(phobia, breaks = c(0, 2, 4, 10), include.lowest = TRUE)) %&gt;% ggplot() + aes(x = mathquiz, y = statquiz, color = phobia_cut3) + geom_point() ## Warning: Removed 15 rows containing missing values (geom_point). data_ihno %&gt;% dplyr::mutate(phobia_cut3 = cut(phobia, breaks = c(0, 2, 4, 10), include.lowest = TRUE)) %&gt;% ggplot() + aes(x = mathquiz, y = statquiz) + geom_count() + facet_grid(. ~ phobia_cut3) ## Warning: Removed 15 rows containing non-finite values (stat_sum). 1.3 Regression 1.3.1 Fit Nested Models (bottom up) fit_ihno_lm_0 &lt;- lm(statquiz ~ 1, data = data_ihno %&gt;% dplyr::filter(complete.cases(mathquiz, statquiz, phobia))) fit_ihno_lm_1 &lt;- lm(statquiz ~ mathquiz, data = data_ihno %&gt;% dplyr::filter(complete.cases(mathquiz, statquiz, phobia))) fit_ihno_lm_2 &lt;- lm(statquiz ~ phobia, data = data_ihno %&gt;% dplyr::filter(complete.cases(mathquiz, statquiz, phobia))) fit_ihno_lm_3 &lt;- lm(statquiz ~ mathquiz + phobia, data = data_ihno %&gt;% dplyr::filter(complete.cases(mathquiz, statquiz, phobia))) fit_ihno_lm_4 &lt;- lm(statquiz ~ mathquiz*phobia, data = data_ihno %&gt;% dplyr::filter(complete.cases(mathquiz, statquiz, phobia))) texreg::screenreg(list(fit_ihno_lm_0, fit_ihno_lm_1, fit_ihno_lm_2, fit_ihno_lm_3, fit_ihno_lm_4), custom.model.names = c(&quot;No Predictors&quot;, &quot;Only Math Quiz&quot;, &quot;Only Phobia&quot;, &quot;Both IVs&quot;, &quot;Add Interaction&quot;)) ## ## ======================================================================================= ## No Predictors Only Math Quiz Only Phobia Both IVs Add Interaction ## --------------------------------------------------------------------------------------- ## (Intercept) 6.85 *** 4.14 *** 7.65 *** 5.02 *** 5.60 *** ## (0.19) (0.53) (0.29) (0.63) (0.91) ## mathquiz 0.09 *** 0.08 *** 0.06 * ## (0.02) (0.02) (0.03) ## phobia -0.25 *** -0.16 * -0.34 ## (0.07) (0.07) (0.21) ## mathquiz:phobia 0.01 ## (0.01) ## --------------------------------------------------------------------------------------- ## R^2 0.00 0.26 0.13 0.31 0.31 ## Adj. R^2 0.00 0.25 0.12 0.29 0.29 ## Num. obs. 85 85 85 85 85 ## RMSE 1.74 1.50 1.63 1.46 1.46 ## ======================================================================================= ## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05 1.3.2 Compare Models Likelihood Ratio Test of Nested Models anova(fit_ihno_lm_0, fit_ihno_lm_1) ## Analysis of Variance Table ## ## Model 1: statquiz ~ 1 ## Model 2: statquiz ~ mathquiz ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 84 253.01 ## 2 83 187.75 1 65.26 28.85 6.999e-07 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 anova(fit_ihno_lm_0, fit_ihno_lm_2) ## Analysis of Variance Table ## ## Model 1: statquiz ~ 1 ## Model 2: statquiz ~ phobia ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 84 253.01 ## 2 83 220.73 1 32.282 12.139 0.0007912 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 anova(fit_ihno_lm_1, fit_ihno_lm_3) ## Analysis of Variance Table ## ## Model 1: statquiz ~ mathquiz ## Model 2: statquiz ~ mathquiz + phobia ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 83 187.75 ## 2 82 175.19 1 12.565 5.8814 0.0175 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 anova(fit_ihno_lm_3, fit_ihno_lm_4) ## Analysis of Variance Table ## ## Model 1: statquiz ~ mathquiz + phobia ## Model 2: statquiz ~ mathquiz * phobia ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 82 175.19 ## 2 81 173.50 1 1.6894 0.7887 0.3771 1.3.3 Final Model texreg::screenreg(fit_ihno_lm_3, custom.model.names = &quot;Main Effects Model&quot;, ci.force = TRUE, caption = &quot;Final Model for Stat&#39;s Quiz&quot;, single.row = TRUE) ## ## =================================== ## Main Effects Model ## ----------------------------------- ## (Intercept) 5.02 [ 3.79; 6.25] * ## mathquiz 0.08 [ 0.05; 0.12] * ## phobia -0.16 [-0.29; -0.03] * ## ----------------------------------- ## R^2 0.31 ## Adj. R^2 0.29 ## Num. obs. 85 ## RMSE 1.46 ## =================================== ## * 0 outside the confidence interval 1.3.4 Plot Model effects::Effect(focal.predictors = c(&quot;mathquiz&quot;, &quot;phobia&quot;), mod = fit_ihno_lm_3, xlevels = list(phobia = c(0, 5, 10))) %&gt;% data.frame %&gt;% dplyr::mutate(phobia = factor(phobia)) %&gt;% ggplot() + aes(x = mathquiz, y = fit, fill = phobia, color = phobia) + geom_ribbon(aes(ymin = fit - se, ymax = fit + se), alpha = .3) + geom_point() + geom_line() + theme_bw() + labs(x = &quot;Score on Math Quiz&quot;, y = &quot;Estimated Marginal Mean\\nScore on Stat Quiz&quot;, fill = &quot;Self Rated\\nMath Phobia&quot;, color = &quot;Self Rated\\nMath Phobia&quot;) + theme(legend.background = element_rect(color = &quot;black&quot;), legend.position = c(0, 1), legend.justification = c(0, 1)) Figure 1.1: Illustration of the effects of the background math quiz score and self-rated math phobia on the baseline statistics quiz. Confidence bands represent one standard error from the mean. "],
["references.html", "References", " References "]
]
