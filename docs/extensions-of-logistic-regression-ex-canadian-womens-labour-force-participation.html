<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression</title>
  <meta name="description" content="Correlation, Model Fit, Generalize, and Plot.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="EQM_v1_cover.png" />
  <meta property="og:description" content="Correlation, Model Fit, Generalize, and Plot." />
  <meta name="github-repo" content="cehs-research/eBook_wrangle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression" />
  
  <meta name="twitter:description" content="Correlation, Model Fit, Generalize, and Plot." />
  <meta name="twitter:image" content="EQM_v1_cover.png" />

<meta name="author" content="Sarah Schwartz &amp; Tyson Barrett">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="heading.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vol. 4: Multiple Linear Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#blocked-notes"><i class="fa fa-check"></i>Blocked Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-and-output"><i class="fa fa-check"></i>Code and Output</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The Authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-choose-r"><i class="fa fa-check"></i>Why choose R ?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#fyi"><i class="fa fa-check"></i>FYI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><i class="fa fa-check"></i><b>1</b> Simple Linear Regression - Ex: Ventricular Shortening Velocity (single continuous IV)</a><ul>
<li class="chapter" data-level="1.1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a><ul>
<li class="chapter" data-level="1.1.1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#research-question"><i class="fa fa-check"></i><b>1.1.1</b> Research Question</a></li>
<li class="chapter" data-level="1.1.2" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#data-description"><i class="fa fa-check"></i><b>1.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#univariate-statistics"><i class="fa fa-check"></i><b>1.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="1.2.2" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#univariate-visualizations"><i class="fa fa-check"></i><b>1.2.2</b> Univariate Visualizations</a></li>
<li class="chapter" data-level="1.2.3" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#bivariate-statistics-unadjusted-pearsons-correlation"><i class="fa fa-check"></i><b>1.2.3</b> Bivariate Statistics (Unadjusted Pearson’s correlation)</a></li>
<li class="chapter" data-level="1.2.4" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#bivariate-visualization"><i class="fa fa-check"></i><b>1.2.4</b> Bivariate Visualization</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#regression-analysis"><i class="fa fa-check"></i><b>1.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="1.3.1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#fit-a-simple-linear-model"><i class="fa fa-check"></i><b>1.3.1</b> Fit A Simple Linear Model</a></li>
<li class="chapter" data-level="1.3.2" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#checking-assumptions-via-residual-diagnostics"><i class="fa fa-check"></i><b>1.3.2</b> Checking Assumptions via Residual Diagnostics</a></li>
<li class="chapter" data-level="1.3.3" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#manually-checking-residual-diagnostics"><i class="fa fa-check"></i><b>1.3.3</b> Manually checking residual diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#conclusion"><i class="fa fa-check"></i><b>1.4</b> Conclusion</a><ul>
<li class="chapter" data-level="1.4.1" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#tabulate-the-final-model-summary"><i class="fa fa-check"></i><b>1.4.1</b> Tabulate the Final Model Summary</a></li>
<li class="chapter" data-level="1.4.2" data-path="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html"><a href="simple-linear-regression-ex-ventricular-shortening-velocity-single-continuous-iv.html#plot-the-model"><i class="fa fa-check"></i><b>1.4.2</b> Plot the Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><i class="fa fa-check"></i><b>2</b> Multiple Linear Regression - Ex: Obesity and Blood Pressure (interaction between a continuous and categorical IVs)</a><ul>
<li class="chapter" data-level="2.1" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#purpose-1"><i class="fa fa-check"></i><b>2.1</b> Purpose</a><ul>
<li class="chapter" data-level="2.1.1" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#research-question-1"><i class="fa fa-check"></i><b>2.1.1</b> Research Question</a></li>
<li class="chapter" data-level="2.1.2" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#data-description-1"><i class="fa fa-check"></i><b>2.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>2.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#univariate-statistics-1"><i class="fa fa-check"></i><b>2.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="2.2.2" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#bivariate-relationships"><i class="fa fa-check"></i><b>2.2.2</b> Bivariate Relationships</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#regression-analysis-1"><i class="fa fa-check"></i><b>2.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#fit-nested-models"><i class="fa fa-check"></i><b>2.3.1</b> Fit Nested Models</a></li>
<li class="chapter" data-level="2.3.2" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#comparing-nested-models"><i class="fa fa-check"></i><b>2.3.2</b> Comparing Nested Models</a></li>
<li class="chapter" data-level="2.3.3" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#checking-assumptions-via-residual-diagnostics-1"><i class="fa fa-check"></i><b>2.3.3</b> Checking Assumptions via Residual Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html"><a href="multiple-linear-regression-ex-obesity-and-blood-pressure-interaction-between-a-continuous-and-categorical-ivs.html#conclusion-1"><i class="fa fa-check"></i><b>2.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><i class="fa fa-check"></i><b>3</b> Multiple Linear Regression - Ex: Ihno’s Experiment (interaction between two continuous IVs)</a><ul>
<li class="chapter" data-level="3.1" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#purpose-2"><i class="fa fa-check"></i><b>3.1</b> Purpose</a><ul>
<li class="chapter" data-level="3.1.1" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#research-question-2"><i class="fa fa-check"></i><b>3.1.1</b> Research Question</a></li>
<li class="chapter" data-level="3.1.2" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#data-description-2"><i class="fa fa-check"></i><b>3.1.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#exploratory-data-analysis-2"><i class="fa fa-check"></i><b>3.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="3.2.1" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#univariate-statistics-2"><i class="fa fa-check"></i><b>3.2.1</b> Univariate Statistics</a></li>
<li class="chapter" data-level="3.2.2" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#bivariate-relationships-1"><i class="fa fa-check"></i><b>3.2.2</b> Bivariate Relationships</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#regression-analysis-2"><i class="fa fa-check"></i><b>3.3</b> Regression Analysis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#subset-the-sample"><i class="fa fa-check"></i><b>3.3.1</b> Subset the Sample</a></li>
<li class="chapter" data-level="3.3.2" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#fit-nested-models-1"><i class="fa fa-check"></i><b>3.3.2</b> Fit Nested Models</a></li>
<li class="chapter" data-level="3.3.3" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#comparing-nested-models-1"><i class="fa fa-check"></i><b>3.3.3</b> Comparing Nested Models</a></li>
<li class="chapter" data-level="3.3.4" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#checking-assumptions-via-residual-diagnostics-2"><i class="fa fa-check"></i><b>3.3.4</b> Checking Assumptions via Residual Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#conclusion-2"><i class="fa fa-check"></i><b>3.4</b> Conclusion</a><ul>
<li class="chapter" data-level="3.4.1" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#tabulate-the-final-model-summary-1"><i class="fa fa-check"></i><b>3.4.1</b> Tabulate the Final Model Summary</a></li>
<li class="chapter" data-level="3.4.2" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#plot-the-model-1"><i class="fa fa-check"></i><b>3.4.2</b> Plot the Model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html"><a href="multiple-linear-regression-ex-ihnos-experiment-interaction-between-two-continuous-ivs.html#write-up"><i class="fa fa-check"></i><b>3.5</b> Write-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><i class="fa fa-check"></i><b>4</b> Logistic Regression - Ex: Bronchopulmonary Dysplasia in Premature Infants</a><ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#background"><i class="fa fa-check"></i><b>4.1</b> Background</a><ul>
<li class="chapter" data-level="4.1.1" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#source"><i class="fa fa-check"></i><b>4.1.1</b> Source</a></li>
<li class="chapter" data-level="4.1.2" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#reference"><i class="fa fa-check"></i><b>4.1.2</b> Reference</a></li>
<li class="chapter" data-level="4.1.3" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#variables"><i class="fa fa-check"></i><b>4.1.3</b> Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#logistic-regresion"><i class="fa fa-check"></i><b>4.2</b> Logistic Regresion</a><ul>
<li class="chapter" data-level="4.2.1" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#fit-the-models"><i class="fa fa-check"></i><b>4.2.1</b> Fit the Models</a></li>
<li class="chapter" data-level="4.2.2" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#gof-measures"><i class="fa fa-check"></i><b>4.2.2</b> GoF Measures</a></li>
<li class="chapter" data-level="4.2.3" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#parameter-estimates"><i class="fa fa-check"></i><b>4.2.3</b> Parameter Estimates</a></li>
<li class="chapter" data-level="4.2.4" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#significance-of-terms"><i class="fa fa-check"></i><b>4.2.4</b> Significance of Terms</a></li>
<li class="chapter" data-level="4.2.5" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#parameter-estimates-1"><i class="fa fa-check"></i><b>4.2.5</b> Parameter Estimates</a></li>
<li class="chapter" data-level="4.2.6" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#marginal-model-plot"><i class="fa fa-check"></i><b>4.2.6</b> Marginal Model Plot</a></li>
<li class="chapter" data-level="4.2.7" data-path="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html"><a href="logistic-regression-ex-bronchopulmonary-dysplasia-in-premature-infants.html#residual-diagnostics"><i class="fa fa-check"></i><b>4.2.7</b> Residual Diagnostics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><i class="fa fa-check"></i><b>5</b> Logistic Regression - Ex: Maternal Risk Factor for Low Birth Weight Delivery</a><ul>
<li class="chapter" data-level="5.1" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#background-1"><i class="fa fa-check"></i><b>5.1</b> Background</a><ul>
<li class="chapter" data-level="5.1.1" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#raw-dataset"><i class="fa fa-check"></i><b>5.1.1</b> Raw Dataset</a></li>
<li class="chapter" data-level="5.1.2" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#declare-factors"><i class="fa fa-check"></i><b>5.1.2</b> Declare Factors</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#exploratory-data-analysis-3"><i class="fa fa-check"></i><b>5.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#logistic-regression---simple-un-adjusted"><i class="fa fa-check"></i><b>5.3</b> Logistic Regression - Simple, un-adjusted</a></li>
<li class="chapter" data-level="5.4" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#logistic-regression---multivariate-with-main-effects-only"><i class="fa fa-check"></i><b>5.4</b> Logistic Regression - Multivariate, with Main Effects Only</a></li>
<li class="chapter" data-level="5.5" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#logistic-regression---multivariate-with-interactions"><i class="fa fa-check"></i><b>5.5</b> Logistic Regression - Multivariate, with Interactions</a><ul>
<li class="chapter" data-level="5.5.1" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#age-and-weight"><i class="fa fa-check"></i><b>5.5.1</b> Age and Weight</a></li>
<li class="chapter" data-level="5.5.2" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#age-and-smoking"><i class="fa fa-check"></i><b>5.5.2</b> Age and Smoking</a></li>
<li class="chapter" data-level="5.5.3" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#weight-and-smoking"><i class="fa fa-check"></i><b>5.5.3</b> Weight and Smoking</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#logistic-regression---multivariate-simplify"><i class="fa fa-check"></i><b>5.6</b> Logistic Regression - Multivariate, Simplify</a><ul>
<li class="chapter" data-level="5.6.1" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#remove-the-least-significant-perdictor-ui"><i class="fa fa-check"></i><b>5.6.1</b> Remove the least significant perdictor: <code>ui</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#logistic-regression---multivariate-final-model"><i class="fa fa-check"></i><b>5.7</b> Logistic Regression - Multivariate, Final Model</a><ul>
<li class="chapter" data-level="5.7.1" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#several-r2-measures-with-the-psclpr2-function"><i class="fa fa-check"></i><b>5.7.1</b> Several <span class="math inline">\(R^2\)</span> measures with the <code>pscl::pR2()</code> function</a></li>
<li class="chapter" data-level="5.7.2" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#parameter-estiamtes-table"><i class="fa fa-check"></i><b>5.7.2</b> Parameter Estiamtes Table</a></li>
<li class="chapter" data-level="5.7.3" data-path="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html"><a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html#marginal-model-plot-1"><i class="fa fa-check"></i><b>5.7.3</b> Marginal Model Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><i class="fa fa-check"></i><b>6</b> Extensions of Logistic Regression - Ex: Canadian Women’s Labour-Force Participation</a><ul>
<li class="chapter" data-level="6.1" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#background-2"><i class="fa fa-check"></i><b>6.1</b> Background</a><ul>
<li class="chapter" data-level="6.1.1" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#raw-dataset-1"><i class="fa fa-check"></i><b>6.1.1</b> Raw Dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#declare-factors-1"><i class="fa fa-check"></i><b>6.1.2</b> Declare Factors</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#exploratory-data-analysis-4"><i class="fa fa-check"></i><b>6.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="6.2.1" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#husbands-income"><i class="fa fa-check"></i><b>6.2.1</b> Husband’s Income</a></li>
<li class="chapter" data-level="6.2.2" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#children-in-home"><i class="fa fa-check"></i><b>6.2.2</b> Children in Home</a></li>
<li class="chapter" data-level="6.2.3" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#region-of-canada"><i class="fa fa-check"></i><b>6.2.3</b> Region of Canada</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#hierarchical-nested-logistic-regression"><i class="fa fa-check"></i><b>6.3</b> Hierarchical (nested) Logistic Regression</a><ul>
<li class="chapter" data-level="6.3.1" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#role-of-predictors-on-any-working"><i class="fa fa-check"></i><b>6.3.1</b> Role of Predictors on ANY working</a></li>
<li class="chapter" data-level="6.3.2" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#role-of-predictors-on-type-of-work"><i class="fa fa-check"></i><b>6.3.2</b> Role of Predictors on TYPE of work</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#multinomial-nominal-logistic-regression"><i class="fa fa-check"></i><b>6.4</b> Multinomial (nominal) Logistic Regression</a></li>
<li class="chapter" data-level="6.5" data-path="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html"><a href="extensions-of-logistic-regression-ex-canadian-womens-labour-force-participation.html#proportional-odds-ordinal-logistic-regression"><i class="fa fa-check"></i><b>6.5</b> Proportional-odds (ordinal) Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Encyclopedia of Quantitative Methods in R, vol. 4: Multiple Linear Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extensions-of-logistic-regression---ex-canadian-womens-labour-force-participation" class="section level1">
<h1><span class="header-section-number">6</span> Extensions of Logistic Regression - Ex: Canadian Women’s Labour-Force Participation</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span>
<span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span>
<span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span>
<span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span>
<span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span>
<span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression</span>
<span class="kw">library</span>(sjPlot)       <span class="co"># Quick plots and tables for models</span>
<span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression (a text book - includes datasets)</span>
<span class="kw">library</span>(MASS)         <span class="co"># Support Functions and Datasets</span>
<span class="kw">library</span>(nnet)         <span class="co">#  Multinomial Log-Linear Models</span></code></pre></div>
<div id="background-2" class="section level2">
<h2><span class="header-section-number">6.1</span> Background</h2>
<p>The <code>Womenlf</code> data frame has 263 rows and 4 columns. The data are from a 1977 survey of the Canadian population.</p>
<p>Dependent variable (DV) or outcome</p>
<ul>
<li><code>partic</code> Labour-Force Participation, a factor with levels:
<ul>
<li><code>fulltime</code> Working full-time<br />
</li>
<li><code>not.work</code> Not working outside the home<br />
</li>
<li><code>parttime</code> Working part-time</li>
</ul></li>
</ul>
<p>Indepdentend variables (IV) or predictors</p>
<ul>
<li><p><code>hincome</code> Husband’s income, in $1000’s</p></li>
<li><code>children</code> Presence of children in the household, a factor with levels:
<ul>
<li><code>absent</code> no children in the home<br />
</li>
<li><code>present</code> at least one child at home</li>
</ul></li>
<li><code>region</code> A factor with levels:
<ul>
<li><code>Atlantic</code> Atlantic Canada</li>
<li><code>BC</code> British Columbia</li>
<li><code>Ontario</code></li>
<li><code>Prairie</code> Prairie provinces</li>
<li><code>Quebec</code></li>
</ul></li>
</ul>
<div id="raw-dataset-1" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Raw Dataset</h3>
<p>The data is included in the <code>carData</code> package which installs and loads with the <code>car</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Womenlf, <span class="dt">package =</span> <span class="st">&quot;carData&quot;</span>)  <span class="co"># load the internal data</span>

tibble<span class="op">::</span><span class="kw">glimpse</span>(Womenlf)            <span class="co"># glimpse a bit of the data</span></code></pre></div>
<pre><code>Observations: 263
Variables: 4
$ partic   &lt;fct&gt; not.work, not.work, not.work, not.work, not.work, not...
$ hincome  &lt;int&gt; 15, 13, 45, 23, 19, 7, 15, 7, 15, 23, 23, 13, 9, 9, 4...
$ children &lt;fct&gt; present, present, present, present, present, present,...
$ region   &lt;fct&gt; Ontario, Ontario, Ontario, Ontario, Ontario, Ontario,...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.), <span class="dt">size =</span> <span class="dv">10</span>))  <span class="co"># select a random sample of 10 rows</span></code></pre></div>
<pre><code># A tibble: 10 x 4
   partic   hincome children region 
   &lt;fct&gt;      &lt;int&gt; &lt;fct&gt;    &lt;fct&gt;  
 1 not.work      23 present  Ontario
 2 parttime       4 present  Ontario
 3 not.work      17 present  Ontario
 4 not.work      23 present  BC     
 5 parttime       8 present  BC     
 6 fulltime      13 absent   Ontario
 7 not.work       9 present  Quebec 
 8 not.work      13 present  Quebec 
 9 not.work       5 present  Quebec 
10 not.work      23 absent   Quebec </code></pre>
<p>Notice the order of the factor levels, especially for the <code>partic</code> factor</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(Womenlf)  <span class="co"># view the structure of the data</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   263 obs. of  4 variables:
 $ partic  : Factor w/ 3 levels &quot;fulltime&quot;,&quot;not.work&quot;,..: 2 2 2 2 2 2 2 1 2 2 ...
 $ hincome : int  15 13 45 23 19 7 15 7 15 23 ...
 $ children: Factor w/ 2 levels &quot;absent&quot;,&quot;present&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ region  : Factor w/ 5 levels &quot;Atlantic&quot;,&quot;BC&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</code></pre>
<p>We can view the order of the factors levels</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf<span class="op">$</span>partic <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">levels</span>()  <span class="co"># view the levels (in order) of the variable</span></code></pre></div>
<pre><code>[1] &quot;fulltime&quot; &quot;not.work&quot; &quot;parttime&quot;</code></pre>
</div>
<div id="declare-factors-1" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Declare Factors</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean &lt;-<span class="st"> </span>Womenlf <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">working_ord  =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(partic <span class="op">==</span><span class="st"> &quot;fulltime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,         <span class="co"># manually re-code a factor</span>
                                                partic <span class="op">==</span><span class="st"> &quot;not.work&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,         <span class="co">#  into a numeric variable</span>
                                                partic <span class="op">==</span><span class="st"> &quot;parttime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),                                     <span class="co"># maually declare the level order</span>
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,                                 <span class="co">#  and labels of the levels)</span>
                                    <span class="st">&quot;Part Time&quot;</span>,
                                    <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st">     </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">working_any  =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(partic <span class="op">==</span><span class="st"> &quot;fulltime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,         <span class="co"># manually re-code a factor</span>
                                                partic <span class="op">==</span><span class="st"> &quot;not.work&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,         <span class="co">#  into a numeric variable</span>
                                                partic <span class="op">==</span><span class="st"> &quot;parttime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),                                        <span class="co"># maually declare the level order</span>
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,                                 <span class="co">#  and labels of the levels)</span>
                                    <span class="st">&quot;At Least Part Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st">     </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">working_full =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(partic <span class="op">==</span><span class="st"> &quot;fulltime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,         <span class="co"># manually re-code a factor</span>
                                                partic <span class="op">==</span><span class="st"> &quot;not.work&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,         <span class="co">#  into a numeric variable</span>
                                                partic <span class="op">==</span><span class="st"> &quot;parttime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),                                        <span class="co"># maually declare the level order</span>
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Less Than Full Time&quot;</span>,                        <span class="co">#  and labels of the levels)</span>
                                    <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st">         </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">working_type =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(partic <span class="op">==</span><span class="st"> &quot;fulltime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,         <span class="co"># manually re-code a factor</span>
                                                partic <span class="op">==</span><span class="st"> &quot;parttime&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)<span class="op">%&gt;%</span><span class="st">      </span><span class="co">#  into a numeric variable</span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),                                        <span class="co"># maually declare the level order</span>
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Part Time&quot;</span>,                                  <span class="co">#  and labels of the levels)</span>
                                    <span class="st">&quot;Full Time&quot;</span>)))                            </code></pre></div>
<p>Display the structure of the ‘clean’ version of the dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(Womenlf_clean)  <span class="co"># view the structure of the data </span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   263 obs. of  8 variables:
 $ partic      : Factor w/ 3 levels &quot;fulltime&quot;,&quot;not.work&quot;,..: 2 2 2 2 2 2 2 1 2 2 ...
 $ hincome     : int  15 13 45 23 19 7 15 7 15 23 ...
 $ children    : Factor w/ 2 levels &quot;absent&quot;,&quot;present&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ region      : Factor w/ 5 levels &quot;Atlantic&quot;,&quot;BC&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
 $ working_ord : Factor w/ 3 levels &quot;Not at All&quot;,&quot;Part Time&quot;,..: 1 1 1 1 1 1 1 3 1 1 ...
 $ working_any : Factor w/ 2 levels &quot;Not at All&quot;,&quot;At Least Part Time&quot;: 1 1 1 1 1 1 1 2 1 1 ...
 $ working_full: Factor w/ 2 levels &quot;Less Than Full Time&quot;,..: 1 1 1 1 1 1 1 2 1 1 ...
 $ working_type: Factor w/ 2 levels &quot;Part Time&quot;,&quot;Full Time&quot;: NA NA NA NA NA NA NA 2 NA NA ...</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-4" class="section level2">
<h2><span class="header-section-number">6.2</span> Exploratory Data Analysis</h2>
<p>Three versions of the outcome</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: output = &quot;html&quot; </span>
<span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span>
<span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span>

Womenlf_clean <span class="op">%&gt;%</span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(working_ord, working_any, 
                    working_full, working_type,
                    <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,              <span class="co"># do NOT restrict to complete cases!!!</span>
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
Mean/Count (SD/%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 263
</td>
</tr>
<tr>
<td>
working_ord
</td>
<td>
</td>
</tr>
<tr>
<td>
Not at All
</td>
<td>
155 (58.9%)
</td>
</tr>
<tr>
<td>
Part Time
</td>
<td>
42 (16%)
</td>
</tr>
<tr>
<td>
Full Time
</td>
<td>
66 (25.1%)
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
0 (0%)
</td>
</tr>
<tr>
<td>
working_any
</td>
<td>
</td>
</tr>
<tr>
<td>
Not at All
</td>
<td>
155 (58.9%)
</td>
</tr>
<tr>
<td>
At Least Part Time
</td>
<td>
108 (41.1%)
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
0 (0%)
</td>
</tr>
<tr>
<td>
working_full
</td>
<td>
</td>
</tr>
<tr>
<td>
Less Than Full Time
</td>
<td>
197 (74.9%)
</td>
</tr>
<tr>
<td>
Full Time
</td>
<td>
66 (25.1%)
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
0 (0%)
</td>
</tr>
<tr>
<td>
working_type
</td>
<td>
</td>
</tr>
<tr>
<td>
Part Time
</td>
<td>
42 (16%)
</td>
</tr>
<tr>
<td>
Full Time
</td>
<td>
66 (25.1%)
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
155 (58.9%)
</td>
</tr>
</tbody>
</table>
<p>Other Predisctors, univariate</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: output = &quot;html&quot; </span>
<span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span>
<span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span>

Womenlf_clean <span class="op">%&gt;%</span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span> =<span class="st"> </span>hincome, 
                    <span class="st">&quot;Children In the Home&quot;</span> =<span class="st"> </span>children, 
                    <span class="st">&quot;Region of Canada&quot;</span> =<span class="st"> </span>region,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
Mean/Count (SD/%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 263
</td>
</tr>
<tr>
<td>
Husband’s Income, $1000’s
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
14.8 (7.2)
</td>
</tr>
<tr>
<td>
Children In the Home
</td>
<td>
</td>
</tr>
<tr>
<td>
absent
</td>
<td>
79 (30%)
</td>
</tr>
<tr>
<td>
present
</td>
<td>
184 (70%)
</td>
</tr>
<tr>
<td>
Region of Canada
</td>
<td>
</td>
</tr>
<tr>
<td>
Atlantic
</td>
<td>
30 (11.4%)
</td>
</tr>
<tr>
<td>
BC
</td>
<td>
29 (11%)
</td>
</tr>
<tr>
<td>
Ontario
</td>
<td>
108 (41.1%)
</td>
</tr>
<tr>
<td>
Prairie
</td>
<td>
31 (11.8%)
</td>
</tr>
<tr>
<td>
Quebec
</td>
<td>
65 (24.7%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: output = &quot;html&quot; </span>
<span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span>
<span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span>

Womenlf_clean <span class="op">%&gt;%</span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span> =<span class="st"> </span>hincome, 
                    <span class="st">&quot;Children In the Home&quot;</span> =<span class="st"> </span>children, 
                    <span class="st">&quot;Region of Canada&quot;</span> =<span class="st"> </span>region,
                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>working_ord, 
                    <span class="dt">row_wise =</span> <span class="ot">TRUE</span>,                        <span class="co"># show row %s rather than default column %s</span>
                    <span class="dt">test =</span> <span class="ot">TRUE</span>,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
Not at All
</th>
<th>
Part Time
</th>
<th>
Full Time
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 155
</td>
<td>
n = 42
</td>
<td>
n = 66
</td>
<td>
</td>
</tr>
<tr>
<td>
Husband’s Income, $1000’s
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.002
</td>
</tr>
<tr>
<td>
</td>
<td>
15.6 (7.2)
</td>
<td>
16.0 (8.1)
</td>
<td>
12.1 (6.1)
</td>
<td>
</td>
</tr>
<tr>
<td>
Children In the Home
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
absent
</td>
<td>
26 (32.9%)
</td>
<td>
7 (8.9%)
</td>
<td>
46 (58.2%)
</td>
<td>
</td>
</tr>
<tr>
<td>
present
</td>
<td>
129 (70.1%)
</td>
<td>
35 (19%)
</td>
<td>
20 (10.9%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Region of Canada
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.71
</td>
</tr>
<tr>
<td>
Atlantic
</td>
<td>
20 (66.7%)
</td>
<td>
4 (13.3%)
</td>
<td>
6 (20%)
</td>
<td>
</td>
</tr>
<tr>
<td>
BC
</td>
<td>
14 (48.3%)
</td>
<td>
8 (27.6%)
</td>
<td>
7 (24.1%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Ontario
</td>
<td>
64 (59.3%)
</td>
<td>
17 (15.7%)
</td>
<td>
27 (25%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Prairie
</td>
<td>
17 (54.8%)
</td>
<td>
6 (19.4%)
</td>
<td>
8 (25.8%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Quebec
</td>
<td>
40 (61.5%)
</td>
<td>
7 (10.8%)
</td>
<td>
18 (27.7%)
</td>
<td>
</td>
</tr>
</tbody>
</table>
<div id="husbands-income" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Husband’s Income</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(hincome,
             <span class="dt">fill =</span> working_ord)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-173-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> working_ord,
             <span class="dt">y =</span> hincome)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="fl">0.2</span>))  <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, 
                 <span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, 
                 <span class="kw">aes</span>(<span class="dt">ymax =</span> ..y.., 
                     <span class="dt">ymin =</span> ..y..),
                 <span class="dt">width =</span> .<span class="dv">75</span>, 
                 <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,
                 <span class="dt">size =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-174-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(hincome,
             <span class="dt">x =</span> working_ord,
             <span class="dt">fill =</span> working_ord)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-175-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(hincome,
             <span class="dt">x =</span> working_ord,
             <span class="dt">fill =</span> working_ord)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-176-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="children-in-home" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Children in Home</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> children,
             <span class="dt">fill =</span> working_ord)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-177-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> children,
             <span class="dt">fill =</span> working_ord <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;fill&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Children in the Home&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Proportion of Women&quot;</span>,
       <span class="dt">fill =</span> <span class="st">&quot;Working&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray25&quot;</span>, <span class="st">&quot;gray50&quot;</span>, <span class="st">&quot;gray75&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-178-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="region-of-canada" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Region of Canada</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> region,
             <span class="dt">fill =</span> working_ord)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-179-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Womenlf_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> region,
             <span class="dt">fill =</span> working_ord <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;fill&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Region of Canada&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Proportion of Women&quot;</span>,
       <span class="dt">fill =</span> <span class="st">&quot;Working&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray25&quot;</span>, <span class="st">&quot;gray50&quot;</span>, <span class="st">&quot;gray75&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-180-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="hierarchical-nested-logistic-regression" class="section level2">
<h2><span class="header-section-number">6.3</span> Hierarchical (nested) Logistic Regression</h2>
<p>For an <span class="math inline">\(m-\)</span>category polytomy dependent variable is respecified as a series of <span class="math inline">\(m – 1\)</span> nested dichotomies. A single or combined levels of outcome compared to another single or combination of levels. Then they are analyzed using a series of binary logistic regressions, such that:</p>
<ul>
<li>Dichotomies selected based on theory</li>
<li>Avoid redundancy</li>
<li>Similar to contrast coding, but for outcome</li>
</ul>
<p>For this dataset example, the outcome (<code>partic</code>) has <span class="math inline">\(3-\)</span>categories, so we will investigate TWO nested dichotomies</p>
<ol style="list-style-type: decimal">
<li>outcome = <code>working_any</code></li>
<li>outcome = <code>working_type</code></li>
</ol>
<div id="role-of-predictors-on-any-working" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Role of Predictors on ANY working</h3>
<p>Fit a regular logistic model with all three predictors regressed on the binary indicator for any working. Use the <code>glm()</code> function in the base <span class="math inline">\(R\)</span> <code>stats</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_glm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(working_any <span class="op">~</span><span class="st"> </span>hincome <span class="op">+</span><span class="st"> </span>children <span class="op">+</span><span class="st"> </span>region,
                 <span class="dt">data =</span> Womenlf_clean,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))

<span class="kw">summary</span>(fit_glm_<span class="dv">1</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = working_any ~ hincome + children + region, family = binomial(link = &quot;logit&quot;), 
    data = Womenlf_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7927  -0.8828  -0.7283   0.9562   2.0074  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.26771    0.55296   2.293   0.0219 *  
hincome         -0.04534    0.02057  -2.204   0.0275 *  
childrenpresent -1.60434    0.30187  -5.315 1.07e-07 ***
regionBC         0.34196    0.58504   0.585   0.5589    
regionOntario    0.18778    0.46762   0.402   0.6880    
regionPrairie    0.47186    0.55680   0.847   0.3967    
regionQuebec    -0.17310    0.49957  -0.347   0.7290    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 356.15  on 262  degrees of freedom
Residual deviance: 317.30  on 256  degrees of freedom
AIC: 331.3

Number of Fisher Scoring iterations: 4</code></pre>
<p>Check if <code>region</code> is statistically significant with the <code>drop1()</code> function from the base <span class="math inline">\(R\)</span> <code>stats</code> package. This may be done with a Likelihood Ratio Test (<code>test = &quot;LRT&quot;</code>, which is the same as <code>test = &quot;Chisq&quot;</code> for <code>glm</code> models).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drop1</span>(fit_glm_<span class="dv">1</span>, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>)</code></pre></div>
<pre><code># A tibble: 4 x 5
     Df Deviance   AIC   LRT    `Pr(&gt;Chi)`
* &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1    NA     317.  331. NA    NA           
2     1     322.  334.  5.13  0.0236      
3     1     348.  360. 30.5   0.0000000326
4     4     320.  326.  2.43  0.657       </code></pre>
<p>Since the region doesn’t have exhibit any effect on odds a women is in the labor force, remove that predictor in the model to simplify to a ‘best’ final model. Also, center husband’s income at a value near the mean so the intercept has meaning.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_glm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(working_any <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(hincome <span class="op">-</span><span class="st"> </span><span class="dv">14</span>) <span class="op">+</span><span class="st"> </span>children,
                 <span class="dt">data =</span> Womenlf_clean,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))

<span class="kw">summary</span>(fit_glm_<span class="dv">2</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = working_any ~ I(hincome - 14) + children, family = binomial(link = &quot;logit&quot;), 
    data = Womenlf_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6767  -0.8652  -0.7768   0.9292   1.9970  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.74351    0.24312   3.058  0.00223 ** 
I(hincome - 14) -0.04231    0.01978  -2.139  0.03244 *  
childrenpresent -1.57565    0.29226  -5.391    7e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 356.15  on 262  degrees of freedom
Residual deviance: 319.73  on 260  degrees of freedom
AIC: 325.73

Number of Fisher Scoring iterations: 4</code></pre>
<p>The <code>texreg</code> package uses an intermediate function called <code>extract()</code> to extract information for the model and then put it in the right places in the table. We can invervene by writing our own <code>extract_exp()</code> function to use instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">extract_exp &lt;-<span class="st"> </span><span class="cf">function</span>(fit_glm){
  beta   =<span class="st"> </span><span class="kw">coef</span>(fit_glm)    
  betaci =<span class="st"> </span><span class="kw">confint</span>(fit_glm) 
  fit_glm_exp        =<span class="st"> </span>texreg<span class="op">::</span><span class="kw">extract</span>(fit_glm)
  fit_glm_exp<span class="op">@</span>coef   =<span class="st"> </span><span class="kw">exp</span>(beta)
  fit_glm_exp<span class="op">@</span>ci.low =<span class="st"> </span><span class="kw">exp</span>(betaci[, <span class="dv">1</span>])
  fit_glm_exp<span class="op">@</span>ci.up  =<span class="st"> </span><span class="kw">exp</span>(betaci[, <span class="dv">2</span>])
  <span class="kw">return</span>(fit_glm_exp)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: texreg::htmlreg()</span>
<span class="co"># Knit to PDF:     texreg::texreg()</span>
<span class="co"># View on Screen:  texreg::screenreg()</span>

texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">extract_exp</span>(fit_glm_<span class="dv">2</span>),
                <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;BL: No children, Husband Earns $14,000/yr&quot;</span>,
                                      <span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span>,
                                      <span class="st">&quot;Children in the Home&quot;</span>),
                <span class="dt">custom.model.names =</span> <span class="st">&quot;OR, Women is in the Workforce at All&quot;</span>,
                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,
                <span class="dt">custom.note =</span> <span class="st">&quot;* The value of &#39;1&#39; is outside the confidence interval for the OR&quot;</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>OR, Women is in the Workforce at All</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BL: No children, Husband Earns $14,000/yr
</td>
<td style="padding-right: 12px; border: none;">
2.10 [1.32; 3.44]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Husband’s Income, $1000’s
</td>
<td style="padding-right: 12px; border: none;">
0.96 [0.92; 1.00]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Children in the Home
</td>
<td style="padding-right: 12px; border: none;">
0.21 [0.12; 0.36]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
325.73
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
336.45
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-159.87
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Deviance
</td>
<td style="padding-right: 12px; border: none;">
319.73
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Num. obs.
</td>
<td style="border-bottom: 2px solid black;">
263
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em">* The value of ‘1’ is outside the confidence interval for the OR</span>
</td>
</tr>
</table>
<p><strong>Interpretation: </strong></p>
<ul>
<li><p>Among women without children in the home and a husband making $14,000 annually, there is about a 2:1 odds she is in the workforce.</p></li>
<li><p>For each additional thousand dollars the husband makes, the odds ratio decreases by about 4 percent.</p></li>
<li><p>If there are children in the home, the odds of being in the workforce is nearly a fifth as large.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">allEffects</span>(fit_glm_<span class="dv">2</span>)</code></pre></div>
<pre><code> model: working_any ~ I(hincome - 14) + children

 hincome effect
hincome
        1        10        20        30        40 
0.5476466 0.4527392 0.3514450 0.2619655 0.1886414 

 children effect
children
   absent   present 
0.6707323 0.2964731 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_glm_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> children,
             <span class="dt">linetype =</span> children)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of</span><span class="ch">\n</span><span class="st">Women Being in the Workforce&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-188-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="role-of-predictors-on-type-of-work" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Role of Predictors on TYPE of work</h3>
<p>Fit a regular logistic model with all three predictors regressed on the binary indicator for level/type of working.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_glm_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(working_type <span class="op">~</span><span class="st"> </span>hincome <span class="op">+</span><span class="st"> </span>children <span class="op">+</span><span class="st"> </span>region,
                 <span class="dt">data =</span> Womenlf_clean,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))

<span class="kw">summary</span>(fit_glm_<span class="dv">3</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = working_type ~ hincome + children + region, family = binomial(link = &quot;logit&quot;), 
    data = Womenlf_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5202  -0.8048   0.3583   0.7201   1.9957  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      3.76164    1.05718   3.558 0.000373 ***
hincome         -0.10475    0.04032  -2.598 0.009383 ** 
childrenpresent -2.74781    0.56893  -4.830 1.37e-06 ***
regionBC        -1.18248    1.02764  -1.151 0.249865    
regionOntario   -0.14876    0.84703  -0.176 0.860589    
regionPrairie   -0.39173    0.96310  -0.407 0.684200    
regionQuebec     0.14842    0.93300   0.159 0.873612    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 144.34  on 107  degrees of freedom
Residual deviance: 101.84  on 101  degrees of freedom
  (155 observations deleted due to missingness)
AIC: 115.84

Number of Fisher Scoring iterations: 5</code></pre>
<p>Check if <code>region</code> is statistically significant with the <code>drop1()</code> function from the base <span class="math inline">\(R\)</span> <code>stats</code> package. This may be done with a Likelihood Ratio Test (<code>test = &quot;LRT&quot;</code>, which is the same as <code>test = &quot;Chisq&quot;</code> for <code>glm</code> models).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drop1</span>(fit_glm_<span class="dv">3</span>, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>)</code></pre></div>
<pre><code># A tibble: 4 x 5
     Df Deviance   AIC   LRT    `Pr(&gt;Chi)`
* &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1    NA     102.  116. NA    NA           
2     1     110.  122.  7.84  0.00512     
3     1     134.  146. 31.9   0.0000000162
4     4     104.  110.  2.65  0.618       </code></pre>
<p>Since the region doesn’t have exhibit any effect on odds a working women is in the labor force full time, remove that predictor in the model to simplify to a ‘best’ final model. Also, center husband’s income at a value near the mean so the intercept has meaning.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_glm_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(working_type <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(hincome <span class="op">-</span><span class="st"> </span><span class="dv">14</span>) <span class="op">+</span><span class="st"> </span>children,
                 <span class="dt">data =</span> Womenlf_clean,
                 <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))

<span class="kw">summary</span>(fit_glm_<span class="dv">4</span>)</code></pre></div>
<pre><code>
Call:
glm(formula = working_type ~ I(hincome - 14) + children, family = binomial(link = &quot;logit&quot;), 
    data = Womenlf_clean)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4047  -0.8678   0.3949   0.6213   1.7641  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.97602    0.43024   4.593 4.37e-06 ***
I(hincome - 14) -0.10727    0.03915  -2.740  0.00615 ** 
childrenpresent -2.65146    0.54108  -4.900 9.57e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 144.34  on 107  degrees of freedom
Residual deviance: 104.49  on 105  degrees of freedom
  (155 observations deleted due to missingness)
AIC: 110.49

Number of Fisher Scoring iterations: 5</code></pre>
<p>The <code>texreg</code> package uses an intermediate function called <code>extract()</code> to extract information for the model and then put it in the right places in the table. We can invervene by writing our own <code>extract_exp()</code> function to use instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: texreg::htmlreg()</span>
<span class="co"># Knit to PDF:     texreg::texreg()</span>
<span class="co"># View on Screen:  texreg::screenreg()</span>

texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_exp</span>(fit_glm_<span class="dv">2</span>), <span class="kw">extract_exp</span>(fit_glm_<span class="dv">4</span>)),
                <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;BL: No children, Husband Earns $14,000/yr&quot;</span>,
                                      <span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span>,
                                      <span class="st">&quot;Children in the Home&quot;</span>),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Working at All&quot;</span>,
                                       <span class="st">&quot;Full vs. Part-Time&quot;</span>),
                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,
                <span class="dt">custom.note =</span> <span class="st">&quot;* The value of &#39;1&#39; is outside the confidence interval for the OR&quot;</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Working at All</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Full vs. Part-Time</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BL: No children, Husband Earns $14,000/yr
</td>
<td style="padding-right: 12px; border: none;">
2.10 [1.32; 3.44]<sup style="vertical-align: 0px;">*</sup>
</td>
<td style="padding-right: 12px; border: none;">
7.21 [3.34; 18.45]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Husband’s Income, $1000’s
</td>
<td style="padding-right: 12px; border: none;">
0.96 [0.92; 1.00]<sup style="vertical-align: 0px;">*</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.90 [0.83; 0.97]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Children in the Home
</td>
<td style="padding-right: 12px; border: none;">
0.21 [0.12; 0.36]<sup style="vertical-align: 0px;">*</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.07 [0.02; 0.19]<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
325.73
</td>
<td style="border-top: 1px solid black;">
110.49
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
336.45
</td>
<td style="padding-right: 12px; border: none;">
118.54
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-159.87
</td>
<td style="padding-right: 12px; border: none;">
-52.25
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Deviance
</td>
<td style="padding-right: 12px; border: none;">
319.73
</td>
<td style="padding-right: 12px; border: none;">
104.49
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Num. obs.
</td>
<td style="border-bottom: 2px solid black;">
263
</td>
<td style="border-bottom: 2px solid black;">
108
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="4">
<span style="font-size:0.8em">* The value of ‘1’ is outside the confidence interval for the OR</span>
</td>
</tr>
</table>
<p><strong>Interpretation: </strong></p>
<ul>
<li><p>Among working women without children in the home and a husband making $14,000 annually, there is more than 7:1 odds she is working full time verses part time.</p></li>
<li><p>For each additional thousand dollars the husband makes, the odds ratio decreases by about 10 percent.</p></li>
<li><p>If there are children in the home, the odds of being in the workforce is drastically reduced.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">allEffects</span>(fit_glm_<span class="dv">4</span>)</code></pre></div>
<pre><code> model: working_type ~ I(hincome - 14) + children

 hincome effect
hincome
        1        10        20        30        40 
0.8829045 0.7416987 0.4955346 0.2515165 0.1031024 

 children effect
children
   absent   present 
0.8830579 0.3475686 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_glm_<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> children,
             <span class="dt">linetype =</span> children)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of</span><span class="ch">\n</span><span class="st">Employed Women Work Full Time vs. Part Time&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-195-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multinomial-nominal-logistic-regression" class="section level2">
<h2><span class="header-section-number">6.4</span> Multinomial (nominal) Logistic Regression</h2>
<p>Multinomial Logistic Regression fits a single model by specifing a reference level of the outcome and comparing each additional level to it. In our case we will choose <code>not working</code> as the reference category adn get a set of parameter estimates (betas) for each of the two options <code>part time</code> and <code>full time</code>.</p>
<p>Use <code>multinom()</code> function in the base <span class="math inline">\(R\)</span> <code>nnet</code> package. You will also need the <code>MASS</code> and <span class="math inline">\(R\)</span> package (only to compute MLEs). Make sure to remove cases with missing data on predictors before modeling or use the <code>na.action = na.omit</code> optin in the <code>multinom()</code> model command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_multnom_<span class="dv">1</span> &lt;-<span class="st"> </span>nnet<span class="op">::</span><span class="kw">multinom</span>(working_ord <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(hincome <span class="op">-</span><span class="st"> </span><span class="dv">14</span>) <span class="op">+</span><span class="st"> </span>children <span class="op">+</span><span class="st"> </span>region,
                                <span class="dt">data =</span> Womenlf_clean)</code></pre></div>
<pre><code># weights:  24 (14 variable)
initial  value 288.935032 
iter  10 value 208.470682
iter  20 value 207.732796
iter  20 value 207.732796
iter  20 value 207.732796
final  value 207.732796 
converged</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit_multnom_<span class="dv">1</span>,
        <span class="dt">corr =</span> <span class="ot">FALSE</span>,
        <span class="dt">wald =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>Call:
nnet::multinom(formula = working_ord ~ I(hincome - 14) + children + 
    region, data = Womenlf_clean)

Coefficients:
          (Intercept) I(hincome - 14) childrenpresent   regionBC
Part Time  -1.7521373     0.005261435       0.1462009  1.0863549
Full Time   0.7240428    -0.100034170      -2.6977927 -0.4599247
          regionOntario regionPrairie regionQuebec
Part Time     0.2856917     0.5747258   -0.1105184
Full Time     0.1135573     0.4681016   -0.3116829

Std. Errors:
          (Intercept) I(hincome - 14) childrenpresent  regionBC
Part Time   0.7204798      0.02468887       0.4901621 0.7193077
Full Time   0.6102008      0.02901623       0.3876731 0.7837044
          regionOntario regionPrairie regionQuebec
Part Time     0.6175050     0.7259118    0.6873048
Full Time     0.6175128     0.7332449    0.6515172

Residual Deviance: 415.4656 
AIC: 443.4656 </code></pre>
<p>Reduce the model by removing the <code>region</code> variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_multnom_<span class="dv">2</span> &lt;-<span class="st"> </span>nnet<span class="op">::</span><span class="kw">multinom</span>(working_ord <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(hincome <span class="op">-</span><span class="st"> </span><span class="dv">14</span>) <span class="op">+</span><span class="st"> </span>children,
                                <span class="dt">data =</span> Womenlf_clean)</code></pre></div>
<pre><code># weights:  12 (6 variable)
initial  value 288.935032 
iter  10 value 211.456740
final  value 211.440963 
converged</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit_multnom_<span class="dv">2</span>,
        <span class="dt">corr =</span> <span class="ot">FALSE</span>,
        <span class="dt">wald =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>Call:
nnet::multinom(formula = working_ord ~ I(hincome - 14) + children, 
    data = Womenlf_clean)

Coefficients:
          (Intercept) I(hincome - 14) childrenpresent
Part Time  -1.3357927      0.00688932      0.02149927
Full Time   0.6215469     -0.09723492     -2.55867912

Std. Errors:
          (Intercept) I(hincome - 14) childrenpresent
Part Time   0.4340062      0.02345463       0.4690285
Full Time   0.2585136      0.02809670       0.3622077

Residual Deviance: 422.8819 
AIC: 434.8819 </code></pre>
<p>Check if we need to keep the <code>region</code> variable in our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_multnom_<span class="dv">1</span>, fit_multnom_<span class="dv">2</span>)</code></pre></div>
<pre><code># A tibble: 2 x 7
  Model        `Resid. df` `Resid. Dev` Test  `   Df` `LR stat.` `Pr(Chi)`
  &lt;fct&gt;              &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1 I(hincome -~         520         423. &quot;&quot;         NA      NA       NA    
2 I(hincome -~         512         415. 1 vs~       8       7.42     0.492</code></pre>
<p>Here is one way to extract the parameter estimates, but recall they are in terms of the <strong>logit</strong> or log-odds, not probability.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">broom<span class="op">::</span><span class="kw">tidy</span>(fit_multnom_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">p.value =</span> <span class="kw">round</span>(p.value, <span class="dv">4</span>))</code></pre></div>
<pre><code># A tibble: 6 x 6
  y.level   term            estimate std.error statistic p.value
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 Part Time (Intercept)       0.263     0.434    -3.08    0.0021
2 Part Time I(hincome - 14)   1.01      0.0235    0.294   0.769 
3 Part Time childrenpresent   1.02      0.469     0.0458  0.963 
4 Full Time (Intercept)       1.86      0.259     2.40    0.0162
5 Full Time I(hincome - 14)   0.907     0.0281   -3.46    0.0005
6 Full Time childrenpresent   0.0774    0.362    -7.06    0     </code></pre>
<p>The <code>effects::allEffects()</code> function provides probability estimates for each outcome level for different levels of the predictors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">allEffects</span>(fit_multnom_<span class="dv">2</span>)</code></pre></div>
<pre><code> model: working_ord ~ I(hincome - 14) + children

hincome effect (probability) for Not at All
hincome
        1        10        20        30        40 
0.4265713 0.5819837 0.6888795 0.7333353 0.7439897 

hincome effect (probability) for Part Time
hincome
        1        10        20        30        40 
0.1041120 0.1511290 0.1916462 0.2185644 0.2375547 

hincome effect (probability) for Full Time
hincome
         1         10         20         30         40 
0.46931674 0.26688731 0.11947430 0.04810031 0.01845552 

children effect (probability) for Not at All
children
   absent   present 
0.3339937 0.7122698 

children effect (probability) for Part Time
children
    absent    present 
0.08828253 0.19236144 

children effect (probability) for Full Time
children
    absent    present 
0.57772376 0.09536878 </code></pre>
<p>The <code>texreg</code> package know how to handle this type of model and displays the parameteri estimates in two seperate columns. It is unable to use the <code>extract_exp()</code> helper function to exponentiate the betas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: texreg::htmlreg()</span>
<span class="co"># Knit to PDF:     texreg::texreg()</span>
<span class="co"># View on Screen:  texreg::screenreg()</span>

texreg<span class="op">::</span><span class="kw">htmlreg</span>(fit_multnom_<span class="dv">2</span>,
                  <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;BL: No children, Husband Earns $14,000/yr&quot;</span>,
                                        <span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span>,
                                        <span class="st">&quot;Children in the Home&quot;</span>),
                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Part Time</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Full Time</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BL: No children, Husband Earns $14,000/yr
</td>
<td style="padding-right: 12px; border: none;">
-1.34 (0.43)<sup style="vertical-align: 0px;">**</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.62 (0.26)<sup style="vertical-align: 0px;">*</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Husband’s Income, $1000’s
</td>
<td style="padding-right: 12px; border: none;">
0.01 (0.02)
</td>
<td style="padding-right: 12px; border: none;">
-0.10 (0.03)<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Children in the Home
</td>
<td style="padding-right: 12px; border: none;">
0.02 (0.47)
</td>
<td style="padding-right: 12px; border: none;">
-2.56 (0.36)<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
434.88
</td>
<td style="border-top: 1px solid black;">
434.88
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
456.31
</td>
<td style="padding-right: 12px; border: none;">
456.31
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-211.44
</td>
<td style="padding-right: 12px; border: none;">
-211.44
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Deviance
</td>
<td style="padding-right: 12px; border: none;">
422.88
</td>
<td style="padding-right: 12px; border: none;">
422.88
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Num. obs.
</td>
<td style="border-bottom: 2px solid black;">
263
</td>
<td style="border-bottom: 2px solid black;">
263
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="4">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_multnom_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</code></pre></div>
<pre><code>          (Intercept) I(hincome - 14) childrenpresent
Part Time   0.2629496       1.0069131      1.02173205
Full Time   1.8618058       0.9073428      0.07740692</code></pre>
<p><strong>Interpretation: </strong></p>
<ul>
<li><p>Among women without children in the home and a husband making $14,000 annually, there is about 1:4 odds she is working part time verses not at all. and a 1.8:1 odds she is working full time.</p></li>
<li><p>For each additional thousand dollars the husband makes, the odds ratio decreases by about 10 percent that she is working full time, yet stay the same that she works part time.</p></li>
<li><p>If there are children in the home, the odds of working part time increase by 2 percent and there is a very unlikely change she works full time.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_multnom_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(hincome, children, <span class="kw">starts_with</span>(<span class="st">&quot;prob&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">none =</span> prob.Not.at.All,
                <span class="dt">part =</span> prob.Part.Time,
                <span class="dt">full =</span> prob.Full.Time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> work_level,
                <span class="dt">value =</span> fit,
                none, part, full) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">work_level =</span> <span class="kw">factor</span>(work_level,
                                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;full&quot;</span>),
                                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,
                                               <span class="st">&quot;Part Time&quot;</span>,
                                               <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> work_level <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,
             <span class="dt">linetype =</span> work_level <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>children, <span class="dt">labeller =</span> label_both) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Woman Works:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Woman Works:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-204-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_multnom_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(hincome, children, <span class="kw">starts_with</span>(<span class="st">&quot;prob&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">none =</span> prob.Not.at.All,
                <span class="dt">part =</span> prob.Part.Time,
                <span class="dt">full =</span> prob.Full.Time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> work_level,
                <span class="dt">value =</span> fit,
                none, part, full) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">work_level =</span> <span class="kw">factor</span>(work_level,
                                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;full&quot;</span>),
                                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,
                                               <span class="st">&quot;Part Time&quot;</span>,
                                               <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> children <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,
             <span class="dt">linetype =</span> children <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>work_level) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-205-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="proportional-odds-ordinal-logistic-regression" class="section level2">
<h2><span class="header-section-number">6.5</span> Proportional-odds (ordinal) Logistic Regression</h2>
<p>This type of logisit regression model forces the predictors to have similar relationship with the outcome (slopes), but different means (intercepts). This is called the proportional odds assumption.</p>
<p>Use <code>polr()</code> function in the base <span class="math inline">\(R\)</span> <code>MASS</code> package. While outcome variable may be a regualr <code>factor</code>, it is prefereable to specify it as an <code>ordered</code> factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_polr_<span class="dv">1</span> &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">polr</span>(working_ord <span class="op">~</span><span class="st"> </span>hincome <span class="op">+</span><span class="st"> </span>children,
                         <span class="dt">data =</span> Womenlf_clean)

<span class="kw">summary</span>(fit_polr_<span class="dv">1</span>)</code></pre></div>
<pre><code>Call:
MASS::polr(formula = working_ord ~ hincome + children, data = Womenlf_clean)

Coefficients:
                  Value Std. Error t value
hincome         -0.0539    0.01949  -2.766
childrenpresent -1.9720    0.28695  -6.872

Intercepts:
                     Value   Std. Error t value
Not at All|Part Time -1.8520  0.3863    -4.7943
Part Time|Full Time  -0.9409  0.3699    -2.5435

Residual Deviance: 441.663 
AIC: 449.663 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_polr_<span class="dv">1</span><span class="op">$</span>zeta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</code></pre></div>
<pre><code>Not at All|Part Time  Part Time|Full Time 
           0.1569171            0.3902663 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_polr_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</code></pre></div>
<pre><code>        hincome childrenpresent 
      0.9475262       0.1391841 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_polr_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">confint</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</code></pre></div>
<pre><code>                    2.5 %    97.5 %
hincome         0.9109815 0.9834852
childrenpresent 0.0784888 0.2422588</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">allEffects</span>(fit_polr_<span class="dv">1</span>)</code></pre></div>
<pre><code> model: working_ord ~ hincome + children

hincome effect (probability) for Not at All
hincome
        1        10        20        30        40 
0.3968718 0.5166413 0.6469356 0.7585238 0.8433820 

hincome effect (probability) for Part Time
hincome
         1         10         20         30         40 
0.22384583 0.21001062 0.17311759 0.12800001 0.08713914 

hincome effect (probability) for Full Time
hincome
         1         10         20         30         40 
0.37928237 0.27334810 0.17994676 0.11347618 0.06947888 

children effect (probability) for Not at All
children
   absent   present 
0.2579513 0.7140863 

children effect (probability) for Part Time
children
   absent   present 
0.2057297 0.1472491 

children effect (probability) for Full Time
children
   absent   present 
0.5363190 0.1386646 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Knit to Website: texreg::htmlreg()</span>
<span class="co"># Knit to PDF:     texreg::texreg()</span>
<span class="co"># View on Screen:  texreg::screenreg()</span>

texreg<span class="op">::</span><span class="kw">htmlreg</span>(fit_polr_<span class="dv">1</span>,
                <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Husband&#39;s Income, $1000&#39;s&quot;</span>,
                                      <span class="st">&quot;Children in the Home&quot;</span>),
                <span class="dt">single.row =</span> <span class="ot">TRUE</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Husband’s Income, $1000’s
</td>
<td style="padding-right: 12px; border: none;">
-0.05 (0.02)<sup style="vertical-align: 0px;">**</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Children in the Home
</td>
<td style="padding-right: 12px; border: none;">
-1.97 (0.29)<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
449.66
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
463.95
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-220.83
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Deviance
</td>
<td style="padding-right: 12px; border: none;">
441.66
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Num. obs.
</td>
<td style="border-bottom: 2px solid black;">
263
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<p><strong>Interpretation: </strong></p>
<ul>
<li><p>Among women without children in the home and a husband making $14,000 annually, there is a 26% chance she is not working, 21% change she is working part time and just over a 53% change she is working full time.</p></li>
<li><p>For each additional thousand dollars the husband makes, the odds ratio decreases by about 5 percent that she is working part time vs not at all and 5% that she is working full time vs part time.</p></li>
<li><p>If there are children in the home, the odds ratio of working part time vs not at all decreases by 86% and similartly the odds ratio fo working full time vs part time also decreases by 86%.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_polr_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(hincome, children, <span class="kw">starts_with</span>(<span class="st">&quot;prob&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">none =</span> prob.Not.at.All,
                <span class="dt">part =</span> prob.Part.Time,
                <span class="dt">full =</span> prob.Full.Time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> work_level,
                <span class="dt">value =</span> fit,
                none, part, full) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">work_level =</span> <span class="kw">factor</span>(work_level,
                                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;full&quot;</span>),
                                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,
                                               <span class="st">&quot;Part Time&quot;</span>,
                                               <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> work_level <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,
             <span class="dt">linetype =</span> work_level <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>children, <span class="dt">labeller =</span> label_both) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Woman Works:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Woman Works:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-214-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;children&quot;</span>),
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">hincome =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">45</span>, <span class="dt">by =</span> .<span class="dv">1</span>)),
                <span class="dt">mod =</span> fit_polr_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(hincome, children, <span class="kw">starts_with</span>(<span class="st">&quot;prob&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">none =</span> prob.Not.at.All,
                <span class="dt">part =</span> prob.Part.Time,
                <span class="dt">full =</span> prob.Full.Time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> work_level,
                <span class="dt">value =</span> fit,
                none, part, full) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">work_level =</span> <span class="kw">factor</span>(work_level,
                                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;full&quot;</span>),
                                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Not at All&quot;</span>,
                                               <span class="st">&quot;Part Time&quot;</span>,
                                               <span class="st">&quot;Full Time&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hincome,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> children <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,
             <span class="dt">linetype =</span> children <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>) <span class="op">+</span><span class="st">   </span><span class="co"># reference line for intercept</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>work_level) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Husband&#39;s Income, in $1000&#39;s&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Children in</span><span class="ch">\n</span><span class="st">the Home:&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-215-1.png" width="576" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-regression-ex-maternal-risk-factor-for-low-birth-weight-delivery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"toc_depth": 3
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
